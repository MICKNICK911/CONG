<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mid-Week Meeting Assignment Schedule</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --border-radius: 10px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: var(--dark-color);
            line-height: 1.6;
        }

        /* Splash Screen */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2c3e50, #3498db);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        #splash-screen h1 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-align: center;
            padding: 0 1rem;
        }

        #splash-screen p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.2rem;
        }

        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-top: 2rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 1.5rem 0;
            text-align: center;
            box-shadow: var(--box-shadow);
            margin-bottom: 1.5rem;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.8;
        }

        .current-date {
            background-color: var(--success-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            font-weight: bold;
            text-align: center;
            margin-bottom: 1rem;
            box-shadow: var(--box-shadow);
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
            background: white;
            padding: 1rem;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .month-selector, .week-selector {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }

        .month-selector select, .week-selector select {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            background-color: white;
        }

        .nav-buttons {
            display: flex;
            gap: 0.5rem;
        }

        button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 0.75rem 1rem;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }

        .current-week-indicator {
            background-color: var(--accent-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            font-weight: bold;
            text-align: center;
            margin-bottom: 1rem;
            display: none;
        }

        .current-week-indicator.active {
            display: block;
        }

        .schedule-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .role-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            transition: var(--transition);
        }

        .role-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .role-header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .role-content {
            padding: 1rem;
        }

        .person {
            padding: 0.75rem;
            border-bottom: 1px solid #eee;
            display: flex;
            flex-direction: column;
        }

        .person:last-child {
            border-bottom: none;
        }

        .person-name {
            white-space: pre-line;
        }

        .name-pair {
            margin-bottom: 0.5rem;
        }

        .name-label {
            font-weight: bold;
            color: var(--primary-color);
            margin-right: 0.5rem;
        }

        .name-value {
            color: var(--dark-color);
        }

        .empty-slot {
            color: #95a5a6;
            font-style: italic;
        }

        footer {
            text-align: center;
            margin-top: 2rem;
            padding: 1rem;
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        /* User Guide Styles */
        .user-guide {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .guide-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: var(--transition);
        }

        .guide-toggle:hover {
            transform: scale(1.1);
            background-color: #2980b9;
        }

        .guide-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .guide-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .guide-content {
            background-color: white;
            width: 90%;
            max-width: 600px;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform: translateY(20px);
            transition: var(--transition);
        }

        .guide-modal.active .guide-content {
            transform: translateY(0);
        }

        .guide-header {
            background-color: var(--primary-color);
            color: white;
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .guide-header h2 {
            margin: 0;
        }

        .guide-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .guide-body {
            padding: 1.5rem;
            max-height: 60vh;
            overflow-y: auto;
        }

        .guide-step {
            margin-bottom: 2rem;
            display: none;
        }

        .guide-step.active {
            display: block;
        }

        .guide-step h3 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .guide-step p {
            margin-bottom: 1rem;
        }

        .guide-step-image {
            background-color: var(--light-color);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
            font-style: italic;
            color: var(--dark-color);
        }

        .guide-navigation {
            display: flex;
            justify-content: space-between;
            padding: 1rem 1.5rem;
            border-top: 1px solid #eee;
        }

        .guide-dots {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            align-items: center;
        }

        .guide-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #ddd;
            cursor: pointer;
            transition: var(--transition);
        }

        .guide-dot.active {
            background-color: var(--secondary-color);
        }

        .guide-feature-highlight {
            background-color: rgba(52, 152, 219, 0.1);
            border: 1px dashed var(--secondary-color);
            border-radius: var(--border-radius);
            padding: 0.5rem;
            margin: 0.5rem 0;
        }

        /* Desktop styles */
        @media (min-width: 768px) {
            .controls {
                flex-direction: row;
                align-items: center;
            }
            
            .month-selector, .week-selector {
                flex: 1;
            }
            
            .schedule-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .schedule-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div id="splash-screen">
        <h1>üìñ Meeting Work Book Assignment Schedule</h1>
        <p>Loading your assignments...</p>
        <div class="loader"></div>
    </div>

    <!-- Main App -->
    <div id="app" style="display: none;">
        <header>
            <div class="container">
                <h1>üìÖ Mid-Week Meeting Assignment Schedule</h1>
                <div class="subtitle">View weekly assignments and responsibilities</div>
            </div>
        </header>

        <div class="container">
            <div id="current-date" class="current-date">
                <!-- Current date will be populated by JavaScript -->
            </div>

            <div class="controls">
                <div class="month-selector">
                    <label for="month-select">üìÖ Month:</label>
                    <select id="month-select">
                        <!-- Months will be populated by JavaScript -->
                    </select>
                </div>
                
                <div class="week-selector">
                    <label for="week-select">üìÜ Week:</label>
                    <select id="week-select">
                        <!-- Weeks will be populated by JavaScript -->
                    </select>
                </div>
                
                <div class="nav-buttons">
                    <button id="prev-week" disabled>
                        ‚óÄÔ∏è
                    </button>
                    <button id="next-week">
                        ‚ñ∂Ô∏è
                    </button>
                </div>
            </div>

            <div id="current-week-indicator" class="current-week-indicator">
                üü¢ This is the current week
            </div>

            <div id="schedule-grid" class="schedule-grid">
                <!-- Schedule will be populated by JavaScript -->
            </div>
        </div>

        <footer>
            <div class="container">
                <p>Mid-Week Meeting Assignment Schedule &copy; 2025</p>
            </div>
        </footer>
    </div>

    <!-- User Guide -->
    <div class="user-guide">
        <button class="guide-toggle">?</button>
    </div>

    <!-- Guide Modal -->
    <div class="guide-modal">
        <div class="guide-content">
            <div class="guide-header">
                <h2>üìñ How to Use This App</h2>
                <button class="guide-close">√ó</button>
            </div>
            <div class="guide-body">
                <div class="guide-step active" id="step-1">
                    <h3>üëã Welcome!</h3>
                    <p>This app helps you view meeting assignments for each week. Let's take a quick tour of the features.</p>
                    <div class="guide-step-image">
                        üìÖ Meeting Assignment Schedule
                    </div>
                    <p>You can always access this guide by clicking the <strong>?</strong> button in the bottom right corner.</p>
                </div>
                
                <div class="guide-step" id="step-2">
                    <h3>üìÖ Month Selection</h3>
                    <p>Use the <strong>Month dropdown</strong> to navigate between different months.</p>
                    <div class="guide-feature-highlight">
                        <strong>Try it:</strong> Select a different month to see assignments for that period
                    </div>
                    <p>The app contains schedules from July to December 2025.</p>
                </div>
                
                <div class="guide-step" id="step-3">
                    <h3>üìÜ Week Selection</h3>
                    <p>Use the <strong>Week dropdown</strong> to view assignments for specific weeks within the selected month.</p>
                    <div class="guide-feature-highlight">
                        <strong>Tip:</strong> Each month has 4-5 weeks of assignments
                    </div>
                    <p>You can also use the <strong>‚óÄÔ∏è ‚ñ∂Ô∏è navigation buttons</strong> to move between weeks quickly.</p>
                </div>
                
                <div class="guide-step" id="step-4">
                    <h3>üü¢ Current Week Indicator</h3>
                    <p>When viewing the current week, you'll see a green indicator at the top.</p>
                    <div class="guide-step-image">
                        üü¢ This is the current week
                    </div>
                    <p>This helps you quickly identify which assignments are for this week's meeting.</p>
                </div>
                
                <div class="guide-step" id="step-5">
                    <h3>üë• Assignment Cards</h3>
                    <p>Each role is displayed in a separate card with the assigned person's name.</p>
                    <div class="guide-step-image">
                        <strong>Bible Reading:</strong><br>
                        John Doe
                    </div>
                    <p>For assignments with two people, you'll see both <strong>Osuani</strong> (Main) and <strong>Boafo</strong> (Assistant) roles.</p>
                </div>
                
                <div class="guide-step" id="step-6">
                    <h3>üéØ You're All Set!</h3>
                    <p>You now know how to use all the features of the Meeting Assignment Schedule.</p>
                    <div class="guide-feature-highlight">
                        <strong>Remember:</strong> The app automatically shows the current week's assignments when you first open it
                    </div>
                    <p>If you need help again, just click the <strong>?</strong> button anytime!</p>
                </div>
            </div>
            <div class="guide-navigation">
                <button id="guide-prev" disabled>Previous</button>
                <div class="guide-dots">
                    <div class="guide-dot active" data-step="1"></div>
                    <div class="guide-dot" data-step="2"></div>
                    <div class="guide-dot" data-step="3"></div>
                    <div class="guide-dot" data-step="4"></div>
                    <div class="guide-dot" data-step="5"></div>
                    <div class="guide-dot" data-step="6"></div>
                </div>
                <button id="guide-next">Next</button>
            </div>
        </div>
    </div>

    <script>
        // Using the exact data provided
        const NoticeData = {
            "july": {
                "id": "july",
                "name": "July 2025",
                "weeks": [
                    {
                        "range": "July 7 - 13",
                        "isCurrent": false
                    },
                    {
                        "range": "July 14 - 20",
                        "isCurrent": false
                    },
                    {
                        "range": "July 21 - 27",
                        "isCurrent": false
                    },
                    {
                        "range": "July 28 - 31",
                        "isCurrent": false
                    }
                ],
                "roles": {
                    "1": [
                        {
                            "text": "Emmanuel Asante",
                            "edited": false
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": false
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": false
                        },
                        {
                            "text": "Alexander Bawuah",
                            "edited": false
                        }
                    ],
                    "2": [
                        {
                            "text": "Hilkiah Entsie",
                            "edited": false
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": false
                        },
                        {
                            "text": "Isaac Ampomah",
                            "edited": false
                        },
                        {
                            "text": "Ephraim Sam",
                            "edited": false
                        }
                    ],
                    "3": [
                        {
                            "text": "Michael Obeng",
                            "edited": false
                        },
                        {
                            "text": "Stanley Yamekpe",
                            "edited": false
                        },
                        {
                            "text": "John Essel",
                            "edited": false
                        },
                        {
                            "text": "Frank Essah",
                            "edited": false
                        }
                    ],
                    "4": [
                        {
                            "text": "Christiana Amponsah & Margaret Entsie",
                            "edited": false
                        },
                        {
                            "text": "Barbara Asamoah & Lois Fosu",
                            "edited": false
                        },
                        {
                            "text": "Dorah Asare & Victoria Yeboah",
                            "edited": false
                        },
                        {
                            "text": "Lilian Ankomah & Rosina Yankson",
                            "edited": false
                        }
                    ],
                    "5": [
                        {
                            "text": "Rebecca Agbenyo & Mercy Entsie",
                            "edited": false
                        },
                        {
                            "text": "Selina Gyamfi & Barbara Amponsah",
                            "edited": false
                        },
                        {
                            "text": "Nhyira Appiah & Jemimah Miezah",
                            "edited": false
                        },
                        {
                            "text": "Dzifa Alonya & Vivian Arhin",
                            "edited": false
                        }
                    ],
                    "6": [
                        {
                            "text": "Nancy Baidoo & Tracy Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Paul Asiedu",
                            "edited": false
                        },
                        {
                            "text": "Reuben Sowolo & Francis Entsie",
                            "edited": false
                        },
                        {
                            "text": "Lois Sowolo & Alimatu Sadia",
                            "edited": false
                        }
                    ],
                    "7": [
                        {
                            "text": "Abel Eshun",
                            "edited": false
                        },
                        {
                            "text": "Alexander Bawuah",
                            "edited": false
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": false
                        },
                        {
                            "text": "Isaac Arhin",
                            "edited": false
                        }
                    ],
                    "8": [
                        {
                            "text": "Michael Appiah",
                            "edited": false
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": false
                        },
                        {
                            "text": "Ahiade",
                            "edited": false
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": false
                        }
                    ],
                    "9": [
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "Derrick Yankson",
                            "edited": false
                        },
                        {
                            "text": "Arhin Kingsley",
                            "edited": false
                        }
                    ],
                    "Chairman": [
                        {
                            "text": "Derrick Yankson",
                            "edited": false
                        },
                        {
                            "text": "Anthony Entsie",
                            "edited": false
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": false
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": false
                        }
                    ],
                    "Opening Prayer": [
                        {
                            "text": "Emmanuel Entsie",
                            "edited": false
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": false
                        },
                        {
                            "text": "Isaac Arhin",
                            "edited": false
                        },
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": false
                        }
                    ],
                    "Closing Prayer": [
                        {
                            "text": "Dickson Onwona",
                            "edited": false
                        },
                        {
                            "text": "Isaac Ampomah",
                            "edited": false
                        },
                        {
                            "text": "Newton Sam",
                            "edited": false
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": false
                        }
                    ]
                },
                "copiedFrom": null
            },
            "august": {
                "id": "august",
                "name": "August 2025",
                "weeks": [
                    {
                        "range": "August 4 - 10",
                        "isCurrent": false
                    },
                    {
                        "range": "August 11 - 17",
                        "isCurrent": false
                    },
                    {
                        "range": "August 18 - 24",
                        "isCurrent": false
                    },
                    {
                        "range": "August 25 - 31",
                        "isCurrent": false
                    }
                ],
                "roles": {
                    "1": [
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": false
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": false
                        },
                        {
                            "text": "Michael Appiah",
                            "edited": false
                        },
                        {
                            "text": "Isaac Ampomah",
                            "edited": false
                        }
                    ],
                    "2": [
                        {
                            "text": "Obed Gyamfi",
                            "edited": false
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": false
                        },
                        {
                            "text": "Emmanuel Asante",
                            "edited": false
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": false
                        }
                    ],
                    "3": [
                        {
                            "text": "Stephen Essilfie",
                            "edited": false
                        },
                        {
                            "text": "Samuel Larbi",
                            "edited": false
                        },
                        {
                            "text": "Sadick Mohammed",
                            "edited": false
                        },
                        {
                            "text": "Ebenezer Normanyo",
                            "edited": false
                        }
                    ],
                    "4": [
                        {
                            "text": "Mawusi Appiah & Naomi Entsie",
                            "edited": false
                        },
                        {
                            "text": "Claudia Sam & Owusuwaa Appiah",
                            "edited": false
                        },
                        {
                            "text": "Joana Entsie & Gloria Adobea",
                            "edited": false
                        },
                        {
                            "text": "Mary Entsie & Adwoa Onwona",
                            "edited": false
                        }
                    ],
                    "5": [
                        {
                            "text": "Joana Ekwama & Adwoa Eshun",
                            "edited": false
                        },
                        {
                            "text": "Augusta Appiah & Mary Entsie",
                            "edited": false
                        },
                        {
                            "text": "Juliana Entsie & Adelaide Allotey",
                            "edited": false
                        },
                        {
                            "text": "Mercy Entsie & Cynthia Sam",
                            "edited": false
                        }
                    ],
                    "6": [
                        {
                            "text": "Shadrach Asare",
                            "edited": false
                        },
                        {
                            "text": "Foster Entsie & Ebenezer Normanyo",
                            "edited": false
                        },
                        {
                            "text": "Emmanuel Entsie",
                            "edited": false
                        },
                        {
                            "text": "Hannah & Claudia Polley",
                            "edited": false
                        }
                    ],
                    "7": [
                        {
                            "text": "Ahiade",
                            "edited": false
                        },
                        {
                            "text": "Ephraim Sam",
                            "edited": false
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": false
                        },
                        {
                            "text": "Abigail Asieduwaa & Elizabeth Yeboah",
                            "edited": false
                        }
                    ],
                    "8": [
                        {
                            "text": "Archibald Entsie",
                            "edited": false
                        },
                        {
                            "text": "Anthony Entsie",
                            "edited": false
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": false
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": false
                        }
                    ],
                    "9": [
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": false
                        }
                    ],
                    "10": [
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "Dickson Onwona",
                            "edited": false
                        }
                    ],
                    "Chairman": [
                        {
                            "text": "Dickson Onwona",
                            "edited": false
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": false
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": false
                        },
                        {
                            "text": "Kingsley Arhin",
                            "edited": false
                        }
                    ],
                    "Opening Prayer": [
                        {
                            "text": "Ephraim Sam",
                            "edited": false
                        },
                        {
                            "text": "Kingsley Arhin",
                            "edited": false
                        },
                        {
                            "text": "Derrick Yankson",
                            "edited": false
                        },
                        {
                            "text": "Emmanuel Asante",
                            "edited": false
                        }
                    ],
                    "Closing Prayer": [
                        {
                            "text": "Reuben Sowolo",
                            "edited": false
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": false
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": false
                        },
                        {
                            "text": "Isaac Arhin",
                            "edited": false
                        }
                    ]
                },
                "copiedFrom": null
            },
            "month_1755087963009": {
                "id": "month_1755087963009",
                "name": "September 2025",
                "weeks": [
                    {
                        "range": "September 1 - 7",
                        "isCurrent": false
                    },
                    {
                        "range": "September 8 - 14",
                        "isCurrent": false
                    },
                    {
                        "range": "September 15 - 21",
                        "isCurrent": false
                    },
                    {
                        "range": "September 22 - 28",
                        "isCurrent": false
                    },
                    {
                        "range": "September 29 - October 5",
                        "isCurrent": false
                    }
                ],
                "roles": {
                    "1": [
                        {
                            "text": "Daniel Boakye",
                            "edited": true
                        },
                        {
                            "text": "Arhin Kingsley",
                            "edited": true
                        },
                        {
                            "text": "Alexander Bawuah",
                            "edited": true
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": true
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        }
                    ],
                    "2": [
                        {
                            "text": "Samuel Onwona",
                            "edited": true
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": true
                        },
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": true
                        },
                        {
                            "text": "Ephraim Sam",
                            "edited": true
                        },
                        {
                            "text": "Emmanuel Asante",
                            "edited": true
                        }
                    ],
                    "3": [
                        {
                            "text": "Francis Entsie",
                            "edited": true
                        },
                        {
                            "text": "Jeromoth Arhin",
                            "edited": true
                        },
                        {
                            "text": "Frank Essah",
                            "edited": true
                        },
                        {
                            "text": "Sadick Mohammed",
                            "edited": true
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": true
                        }
                    ],
                    "4": [
                        {
                            "text": "Tracy Yeboah & Mercy Entsie",
                            "edited": true
                        },
                        {
                            "text": "Alimatu Saadia & Lois Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Owusuwaa Appiah & Margaret Entsie",
                            "edited": true
                        },
                        {
                            "text": "Victoria Yeboah & Naomi Entsie",
                            "edited": true
                        },
                        {
                            "text": "Elizabeth Yeboah & Lois Ofosu",
                            "edited": true
                        }
                    ],
                    "5": [
                        {
                            "text": "Naomi Entsie & Barbara Asamoah",
                            "edited": true
                        },
                        {
                            "text": "Gloria Adobea & Jemimah Miezah",
                            "edited": true
                        },
                        {
                            "text": "Perlita Gyamfua & Joana Ekwama Entsie",
                            "edited": true
                        },
                        {
                            "text": "Winifred Appiah  & Mary Entsie",
                            "edited": true
                        },
                        {
                            "text": "Jemimah Miezah & Joana Entsie",
                            "edited": true
                        }
                    ],
                    "6": [
                        {
                            "text": "Stephanie Onwona & Augusta Appiah",
                            "edited": true
                        },
                        {
                            "text": "Emmanuel Entsie",
                            "edited": true
                        },
                        {
                            "text": "Rosina Yankson & Nancy Baidoo",
                            "edited": true
                        },
                        {
                            "text": "Adwoa Onwona & Claudia Polley",
                            "edited": true
                        },
                        {
                            "text": "Paul Asiedu",
                            "edited": true
                        }
                    ],
                    "7": [
                        {
                            "text": "Ahiade",
                            "edited": true
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": true
                        },
                        {
                            "text": "Asuafo",
                            "edited": true
                        },
                        {
                            "text": "Alexander Bawuah",
                            "edited": true
                        }
                    ],
                    "8": [
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Nea Asafo Atumi Aye",
                            "edited": true
                        },
                        {
                            "text": "Ahiade",
                            "edited": true
                        },
                        {
                            "text": "Arhin Kingsley",
                            "edited": true
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        }
                    ],
                    "9": [
                        {
                            "text": "",
                            "edited": true
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        },
                        {
                            "text": "Dickson Onwona",
                            "edited": true
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": true
                        },
                        {
                            "text": "",
                            "edited": true
                        }
                    ],
                    "Chairman": [
                        {
                            "text": "Collins Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Michael Appiah",
                            "edited": true
                        },
                        {
                            "text": "Derrick Yankson",
                            "edited": true
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": true
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        }
                    ],
                    "Opening Prayer": [
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": true
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": true
                        },
                        {
                            "text": "Emmanuel Asante",
                            "edited": true
                        },
                        {
                            "text": "Michael Appiah",
                            "edited": true
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        }
                    ],
                    "Closing Prayer": [
                        {
                            "text": "Isaac Arhin",
                            "edited": true
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": true
                        },
                        {
                            "text": "Reuben Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Isaac Ampomah",
                            "edited": true
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": true
                        }
                    ]
                },
                "copiedFrom": "july"
            },
            "month_1755087993804": {
                "id": "month_1755087993804",
                "name": "October 2025",
                "weeks": [
                    {
                        "range": "October 6 - 12",
                        "isCurrent": false
                    },
                    {
                        "range": "October 13 - 19",
                        "isCurrent": false
                    },
                    {
                        "range": "October 20 - 26",
                        "isCurrent": true
                    },
                    {
                        "range": "October 27 - November 2",
                        "isCurrent": false
                    }
                ],
                "roles": {
                    "1": [
                        {
                            "text": "Ephraim Sam",
                            "edited": true
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Isaac Ampomah",
                            "edited": true
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": true
                        }
                    ],
                    "2": [
                        {
                            "text": "Isaac Ampomah",
                            "edited": true
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": true
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": true
                        }
                    ],
                    "3": [
                        {
                            "text": "Foster Entsie",
                            "edited": true
                        },
                        {
                            "text": "Jesse Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Asante Emmauel",
                            "edited": true
                        },
                        {
                            "text": "Reuben Sowolo",
                            "edited": true
                        }
                    ],
                    "4": [
                        {
                            "text": "Clara Prempeh & Lilian Ankomah",
                            "edited": true
                        },
                        {
                            "text": "Priscilla Essel & Esther Takie",
                            "edited": true
                        },
                        {
                            "text": "Selina Gyamfi & Abigail Asiedu",
                            "edited": true
                        },
                        {
                            "text": "Esther Ofori & Esther Takie",
                            "edited": true
                        }
                    ],
                    "5": [
                        {
                            "text": "Adelaide Allotey & Lois Ofosu",
                            "edited": true
                        },
                        {
                            "text": "Barbara Amponsah & Vivian Arhin",
                            "edited": true
                        },
                        {
                            "text": "Erica Sowolo & Claudia Sam",
                            "edited": true
                        },
                        {
                            "text": "Joana Entsie & Claudia Polley",
                            "edited": true
                        }
                    ],
                    "6": [
                        {
                            "text": "Cynthia Sam & Joana Ekwama Entsie",
                            "edited": true
                        },
                        {
                            "text": "Sis Atobora & Margaret Entsie",
                            "edited": true
                        },
                        {
                            "text": "Dorah Asare & Adwoa Eshun",
                            "edited": true
                        },
                        {
                            "text": "Isaac Arhin",
                            "edited": true
                        }
                    ],
                    "7": [
                        {
                            "text": "Rebecca Agbenyo & Hannah Adumoah",
                            "edited": true
                        },
                        {
                            "text": "Juliana Entsie & Mawusi Appiah",
                            "edited": true
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        },
                        {
                            "text": "Ahiade",
                            "edited": true
                        }
                    ],
                    "8": [
                        {
                            "text": "Collins Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Hilkiah Entsie",
                            "edited": true
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": true
                        },
                        {
                            "text": "Anthony Entsie",
                            "edited": true
                        }
                    ],
                    "9": [
                        {
                            "text": "Michael Appiah",
                            "edited": true
                        },
                        {
                            "text": "Derrick Yankson",
                            "edited": true
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": true
                        }
                    ],
                    "Opening Prayer": [
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Reuben Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Kingsley Arhin",
                            "edited": true
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": true
                        }
                    ],
                    "Chairman": [
                        {
                            "text": "Arhin Kingsley",
                            "edited": true
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        },
                        {
                            "text": "Dickson Onwona",
                            "edited": true
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        }
                    ],
                    "Closing Prayer": [
                        {
                            "text": "Dickson Onwona",
                            "edited": true
                        },
                        {
                            "text": "Paul Asiedu",
                            "edited": true
                        },
                        {
                            "text": "Ephraim Sam",
                            "edited": true
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        }
                    ]
                },
                "copiedFrom": "august"
            },
            "month_1760118057198": {
                "id": "month_1760118057198",
                "name": "November 2025",
                "weeks": [
                    {
                        "range": "November 3 - 9",
                        "isCurrent": false
                    },
                    {
                        "range": "November 10 - 16",
                        "isCurrent": false
                    },
                    {
                        "range": "November 17 - 23",
                        "isCurrent": false
                    },
                    {
                        "range": "November 24 - 30",
                        "isCurrent": false
                    }
                ],
                "roles": {
                    "1": [
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": true
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": true
                        }
                    ],
                    "2": [
                        {
                            "text": "Ephraim Sam",
                            "edited": true
                        },
                        {
                            "text": "Kingsley Arhin",
                            "edited": true
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": true
                        },
                        {
                            "text": "Isaac Ampomah",
                            "edited": true
                        }
                    ],
                    "3": [
                        {
                            "text": "Jeromoth Arhin",
                            "edited": true
                        },
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": true
                        },
                        {
                            "text": "Stanley Yamekpe",
                            "edited": true
                        },
                        {
                            "text": "Dickson Onwona",
                            "edited": true
                        }
                    ],
                    "4": [
                        {
                            "text": "Barbara Asamoah & Joana Entsie",
                            "edited": true
                        },
                        {
                            "text": "Hannah Adumoah & Cynthia Sam",
                            "edited": true
                        },
                        {
                            "text": "Mariama Mohammed & Jemimah Miezah",
                            "edited": true
                        },
                        {
                            "text": "Lilian Bawuah & Juliana Entsie",
                            "edited": true
                        }
                    ],
                    "5": [
                        {
                            "text": "Lois Ofosu & Owusuwaa Appiah",
                            "edited": true
                        },
                        {
                            "text": "Nhyira Appiah & Adwoa Onwona",
                            "edited": true
                        },
                        {
                            "text": "Abigail Asiedu & Dora Asare",
                            "edited": true
                        },
                        {
                            "text": "Mawusi Appiah & Mary Entsie",
                            "edited": true
                        }
                    ],
                    "6": [
                        {
                            "text": "Mary Entsie & Adelaide Allotey",
                            "edited": true
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": true
                        },
                        {
                            "text": "Margaret Entsie & Pricilla Essel",
                            "edited": true
                        },
                        {
                            "text": "Emmanuel Entsie",
                            "edited": true
                        }
                    ],
                    "7": [
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": true
                        },
                        {
                            "text": "Vivian Arhin & Claudia Sam",
                            "edited": true
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": true
                        }
                    ],
                    "8": [
                        {
                            "text": "Derrick Yankson",
                            "edited": true
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        },
                        {
                            "text": "Alexander Bawuah",
                            "edited": true
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        }
                    ],
                    "9": [
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "Michael Appiah",
                            "edited": true
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        },
                        {
                            "text": "",
                            "edited": true
                        }
                    ],
                    "Chairman": [
                        {
                            "text": "Anthony Entsie",
                            "edited": true
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": true
                        }
                    ],
                    "Opening Prayer": [
                        {
                            "text": "Emmanuel Asante",
                            "edited": true
                        },
                        {
                            "text": "Reuben Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Anthony Entsie",
                            "edited": true
                        },
                        {
                            "text": "Michael Appiah",
                            "edited": true
                        }
                    ],
                    "Closing Prayer": [
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Emmanuel Entsie",
                            "edited": true
                        },
                        {
                            "text": "Isaac Arhin",
                            "edited": true
                        },
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": true
                        }
                    ]
                },
                "copiedFrom": "month_1755087963009"
            },
            "month_1760118260050": {
                "id": "month_1760118260050",
                "name": "December 2025",
                "weeks": [
                    {
                        "range": "December 1 - 7",
                        "isCurrent": false
                    },
                    {
                        "range": "December 8 - 14",
                        "isCurrent": false
                    },
                    {
                        "range": "December 15 - 21",
                        "isCurrent": false
                    },
                    {
                        "range": "December 22 - 28",
                        "isCurrent": false
                    },
                    {
                        "range": "December 29 - January 4",
                        "isCurrent": false
                    }
                ],
                "roles": {
                    "1": [
                        {
                            "text": "Alexander Bawuah",
                            "edited": true
                        },
                        {
                            "text": "Emmanuel Asante",
                            "edited": true
                        },
                        {
                            "text": "Derrick Yankson",
                            "edited": true
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        },
                        {
                            "text": "Anthony Entsie",
                            "edited": true
                        }
                    ],
                    "2": [
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": true
                        },
                        {
                            "text": "Michael Appiah",
                            "edited": true
                        },
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": true
                        }
                    ],
                    "3": [
                        {
                            "text": "Ebenezer Normanyo",
                            "edited": true
                        },
                        {
                            "text": "Jonathan Arthur",
                            "edited": true
                        },
                        {
                            "text": "Ephraim Sam",
                            "edited": true
                        },
                        {
                            "text": "Samuel Larbi",
                            "edited": true
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": true
                        }
                    ],
                    "4": [
                        {
                            "text": "Gloria Adobea & Juliana Entsie",
                            "edited": true
                        },
                        {
                            "text": "Christiana Amponsah & Adwoa Onwona",
                            "edited": true
                        },
                        {
                            "text": "Alimatu Saadia & Lois Soworlo",
                            "edited": true
                        },
                        {
                            "text": "Mercy Entsie & Rebecca Abgenyo",
                            "edited": true
                        },
                        {
                            "text": "Erica Sowolo & Rosina Yankson",
                            "edited": true
                        }
                    ],
                    "5": [
                        {
                            "text": "Naomi Entsie & Tracy Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Perlita Gyamfua & Joana Entsie",
                            "edited": true
                        },
                        {
                            "text": "Cynthia Sam & Stephanie Onwona",
                            "edited": true
                        },
                        {
                            "text": "Dorah Asare & Nancy Baidoo",
                            "edited": true
                        },
                        {
                            "text": "Claudia Sam & Sis Atobora",
                            "edited": true
                        }
                    ],
                    "6": [
                        {
                            "text": "Esther Takie & Selina Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Adwoa Eshun & Victoria Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Joana E. Entsie & Elizabeth Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Augusta Appiah & Winifred Appiah",
                            "edited": true
                        },
                        {
                            "text": "Paul Asiedu",
                            "edited": true
                        }
                    ],
                    "7": [
                        {
                            "text": "Ahiade - 15",
                            "edited": true
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": true
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": true
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Ahiade - 15",
                            "edited": true
                        }
                    ],
                    "8": [
                        {
                            "text": "Circuit Overseer First Talk",
                            "edited": true
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": true
                        },
                        {
                            "text": "Nea Asafo Aye",
                            "edited": true
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Dickson Onwona",
                            "edited": true
                        }
                    ],
                    "9": [
                        {
                            "text": "",
                            "edited": true
                        },
                        {
                            "text": "",
                            "edited": true
                        },
                        {
                            "text": "Anthony Entsie",
                            "edited": true
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": false
                        }
                    ],
                    "Opening Prayer": [
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": true
                        },
                        {
                            "text": "Paul Asiedu",
                            "edited": true
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Kingsley Arhin",
                            "edited": true
                        }
                    ],
                    "Chairman": [
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Dickson Onwona",
                            "edited": true
                        },
                        {
                            "text": "Kingsley Arhin",
                            "edited": true
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        },
                        {
                            "text": "Derrick Yankson",
                            "edited": true
                        }
                    ],
                    "Closing Prayer": [
                        {
                            "text": "Ephraim Sam",
                            "edited": true
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        },
                        {
                            "text": "Reuben Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Alexander Bawuah",
                            "edited": true
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": true
                        }
                    ]
                },
                "copiedFrom": "month_1755087993804"
            }
        };

        // App state
        let currentMonth = '';
        let currentWeekIndex = 0;
        let currentGuideStep = 1;
        const totalGuideSteps = 6;

        // DOM elements
        const splashScreen = document.getElementById('splash-screen');
        const app = document.getElementById('app');
        const currentDateElement = document.getElementById('current-date');
        const monthSelect = document.getElementById('month-select');
        const weekSelect = document.getElementById('week-select');
        const prevWeekBtn = document.getElementById('prev-week');
        const nextWeekBtn = document.getElementById('next-week');
        const currentWeekIndicator = document.getElementById('current-week-indicator');
        const scheduleGrid = document.getElementById('schedule-grid');

        // Guide elements
        const guideToggle = document.querySelector('.guide-toggle');
        const guideModal = document.querySelector('.guide-modal');
        const guideClose = document.querySelector('.guide-close');
        const guidePrev = document.getElementById('guide-prev');
        const guideNext = document.getElementById('guide-next');
        const guideDots = document.querySelectorAll('.guide-dot');

        // Role name mapping
        const roleNameMap = {
            "1": "Bible Mu Akorade",
            "2": "Tweetwee Bible Mu", 
            "3": "Bible Akenkan",
            "Chairman": "Chairman",
            "Opening Prayer": "Opening Prayer",
            "Closing Prayer": "Closing Prayer"
        };

        // Initialize the app
        function init() {
            // Show splash screen for 3 seconds
            setTimeout(() => {
                splashScreen.style.opacity = '0';
                setTimeout(() => {
                    splashScreen.style.display = 'none';
                    app.style.display = 'block';
                    
                    // Show guide for first-time users
                    const hasSeenGuide = localStorage.getItem('hasSeenGuide');
                    if (!hasSeenGuide) {
                        setTimeout(() => {
                            showGuide();
                            localStorage.setItem('hasSeenGuide', 'true');
                        }, 1000);
                    }
                }, 500);
            }, 3000);

            // Find current week based on 2025 date
            findCurrentWeek();
            
            // Update current date
            updateCurrentDate();
            
            // Initialize the rest of the app
            populateMonthSelect();
            updateWeekSelect();
            renderSchedule();
            setupEventListeners();
            
            // Update date every 60 minute
            setInterval(updateCurrentDate, 3600000);
        }

        // Guide functions
        function showGuide() {
            guideModal.classList.add('active');
            currentGuideStep = 1;
            updateGuide();
        }

        function hideGuide() {
            guideModal.classList.remove('active');
        }

        function updateGuide() {
            // Hide all steps
            document.querySelectorAll('.guide-step').forEach(step => {
                step.classList.remove('active');
            });
            
            // Show current step
            document.getElementById(`step-${currentGuideStep}`).classList.add('active');
            
            // Update dots
            guideDots.forEach(dot => {
                dot.classList.remove('active');
                if (parseInt(dot.dataset.step) === currentGuideStep) {
                    dot.classList.add('active');
                }
            });
            
            // Update button states
            guidePrev.disabled = currentGuideStep === 1;
            guideNext.textContent = currentGuideStep === totalGuideSteps ? 'Finish' : 'Next';
        }

        function nextGuideStep() {
            if (currentGuideStep < totalGuideSteps) {
                currentGuideStep++;
                updateGuide();
            } else {
                hideGuide();
            }
        }

        function prevGuideStep() {
            if (currentGuideStep > 1) {
                currentGuideStep--;
                updateGuide();
            }
        }

        function goToGuideStep(step) {
            currentGuideStep = step;
            updateGuide();
        }

        // Get current 2025 date
        function getCurrent2025Date() {
            const now = new Date();
            // Set year to 2025 while keeping current month and day
            
            //return new Date(2025, now.getMonth(), now.getDate());
            return now;
        }

        // Find current week based on 2025 date
        function findCurrentWeek() {
            const currentDate = getCurrent2025Date();
            const currentMonthNum = currentDate.getMonth() + 1;
            const currentDay = currentDate.getDate();
            
            // Convert month number to name
            const monthNames = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];
            const currentMonthName = monthNames[currentMonthNum - 1];
            
            // Find the current month in our data
            let foundMonth = null;
            let foundWeekIndex = -1;
            
            // Look for exact month match
            for (const monthId in NoticeData) {
                const month = NoticeData[monthId];
                if (month.name.includes(currentMonthName)) {
                    foundMonth = month;
                    break;
                }
            }
            
            // If we found the month, find the current week
            if (foundMonth) {
                foundMonth.weeks.forEach((week, index) => {
                    // Extract start and end dates from the range string
                    const rangeParts = week.range.split(' - ');
                    const startDate = parseInt(rangeParts[0].split(' ')[1]);
                    //let endDate = parseInt(rangeParts[1].split(' ')[1]);
                    
                    let endDate = parseInt(rangeParts[1]);
                    
                    // Handle case where end date might be in next month
                    if (isNaN(endDate)) {
                        /*endDate = parseInt(rangeParts[1] );*/
                        
                 endDate = parseInt(rangeParts[1].split(' ')[1])       
                    }
                    
                    // Check if current date falls within this week
                    if (currentDay >= startDate || currentDay <= endDate || currentDay >= startDate - 6) {
                       foundWeekIndex = index;
                    }
                });
                
                if (foundWeekIndex !== -1) {
                    currentMonth = foundMonth.id;
                    currentWeekIndex = foundWeekIndex;
                    return;
                }
            }
            
            // Fallback: use the data's isCurrent flag
            for (const monthId in NoticeData) {
                const month = NoticeData[monthId];
                const currentWeek = month.weeks.findIndex(week => week.isCurrent);
                if (currentWeek !== -1) {
                    currentMonth = month.id;
                    currentWeekIndex = currentWeek;
                    return;
                }
            }
            
            // Final fallback: use first month and first week
            const firstMonth = Object.values(NoticeData)[0];
            currentMonth = firstMonth.id;
            currentWeekIndex = 0;
        }

        // Update current date display with 2025 date
        function updateCurrentDate() {
            const currentDate = getCurrent2025Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            currentDateElement.textContent = `üìÖ ${currentDate.toLocaleDateString('en-US', options)}`;
            
            // Check if we need to update the current week
            const currentDay = currentDate.getDate();
            const currentMonthNum = currentDate.getMonth() + 1;
            const monthNames = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];
            const currentMonthName = monthNames[currentMonthNum - 1];
            
            // Check if current week has changed
            const currentMonthData = NoticeData[currentMonth];
            if (currentMonthData && currentMonthData.name.includes(currentMonthName)) {
                const week = currentMonthData.weeks[currentWeekIndex];
                if (week) {
                    const rangeParts = week.range.split(' - ');
                    const startDate = parseInt(rangeParts[0].split(' ')[1]);
                    //let endDate = parseInt(rangeParts[1].split(' ')[1]);
                    
                    endDate = parseInt(rangeParts[1]);
                    
                    if (isNaN(endDate)) {
                        //endDate = parseInt(rangeParts[1]);
                        
               endDate = parseInt(rangeParts[1].split(' ')[1]);
                    }
                    
                    // If current date is outside the current week range, find the correct week
                    if (currentDay < startDate || currentDay > endDate || currentDay >= startDate - 6) {
                        findCurrentWeek();
                        updateWeekSelect();
                        renderSchedule();
                    }
                }
            }
        }

        // Populate month dropdown
        function populateMonthSelect() {
            monthSelect.innerHTML = '';
            
            Object.values(NoticeData).forEach(month => {
                const option = document.createElement('option');
                option.value = month.id;
                option.textContent = month.name;
                monthSelect.appendChild(option);
            });
            
            monthSelect.value = currentMonth;
        }

        // Update week dropdown based on selected month
        function updateWeekSelect() {
            weekSelect.innerHTML = '';
            const month = NoticeData[currentMonth];
            
            month.weeks.forEach((week, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = week.range;
                weekSelect.appendChild(option);
            });
            
            weekSelect.value = currentWeekIndex;
            
            // Update navigation buttons state
            prevWeekBtn.disabled = currentWeekIndex === 0;
            nextWeekBtn.disabled = currentWeekIndex === month.weeks.length - 1;
            
            // Show current week indicator if this is the current week
            const currentDate = getCurrent2025Date();
            const currentDay = currentDate.getDate();
            const currentMonthNum = currentDate.getMonth() + 1;
            const monthNames = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];
            const currentMonthName = monthNames[currentMonthNum - 1];
            
            const currentMonthData = NoticeData[currentMonth];
            const isCurrentWeek = currentMonthData && 
                                 currentMonthData.name.includes(currentMonthName) &&
                                 currentMonthData.weeks[currentWeekIndex] && 
                                 (() => {
                                     const week = currentMonthData.weeks[currentWeekIndex];
                                     const rangeParts = week.range.split(' - ');
                                     const startDate = parseInt(rangeParts[0].split(' ')[1]);
                                     let endDate = parseInt(rangeParts[1].split(' ')[1]);
                                     if (isNaN(endDate)) endDate = parseInt(rangeParts[1]);
                                     return currentDay >= startDate && currentDay <= endDate;
                                 })();
            
            currentWeekIndicator.classList.toggle('active', isCurrentWeek);
        }

        // Format names with "&" to use Osuani/Boafo format
        function formatNames(text) {
            if (text.includes('&')) {
                const parts = text.split('&').map(part => part.trim());
                if (parts.length === 2) {
                    return {
                        osuani: parts[0],
                        boafo: parts[1]
                    };
                }
            }
            return text;
        }

        // Get display name for role
        function getRoleDisplayName(roleName) {
            // Check if role has a custom display name
            if (roleNameMap[roleName]) {
                return roleNameMap[roleName];
            }
            
            // Check if role is a number (for Dwumadi roles)
            if (!isNaN(roleName) && parseInt(roleName) > 3) {
                const roleNum = parseInt(roleName);
                const month = NoticeData[currentMonth];
                const numericRoles = Object.keys(month.roles)
                    .filter(key => !isNaN(key) && month.roles[key][currentWeekIndex].text)
                    .map(Number)
                    .sort((a, b) => a - b);
                
                // Check if this is the last numeric role
                if (roleNum === numericRoles[numericRoles.length - 1]) {
                    return "Asafo Bible Adesua";
                } else {
                    return `Dwumadi ${roleNum}`;
                }
            }
            
            // Default: return the original role name
            return roleName;
        }

        // Render the schedule for the selected week
        function renderSchedule() {
            scheduleGrid.innerHTML = '';
            const month = NoticeData[currentMonth];
            const roles = month.roles;
            
            // Get all role names and sort them in the required order
            const roleNames = Object.keys(roles);
            
            // Sort roles in the required order
            const sortedRoleNames = roleNames.sort((a, b) => {
                const order = [
                    "Chairman",
                    "Opening Prayer",
                    "1", "2", "3"  // These will be renamed
                ];
                
                // Add numeric roles (4 and above)
                const numericRoles = roleNames
                    .filter(name => !isNaN(name) && parseInt(name) > 3 && roles[name][currentWeekIndex].text)
                    .map(Number)
                    .sort((a, b) => a - b)
                    .map(String);
                
                // Add closing prayer at the end
                order.push(...numericRoles, "Closing Prayer");
                
                return order.indexOf(a) - order.indexOf(b);
            });
            
            // Render each role
            sortedRoleNames.forEach(roleName => {
                const assignment = roles[roleName][currentWeekIndex];
                
                // Skip roles with no assignment
                if (!assignment.text) return;
                
                const roleCard = document.createElement('div');
                roleCard.className = 'role-card';
                
                const roleHeader = document.createElement('div');
                roleHeader.className = 'role-header';
                roleHeader.textContent = getRoleDisplayName(roleName);
                
                const roleContent = document.createElement('div');
                roleContent.className = 'role-content';
                
                const person = document.createElement('div');
                person.className = 'person';
                
                const formattedNames = formatNames(assignment.text);
                
                if (typeof formattedNames === 'object') {
                    // Create Osuani and Boafo elements with styling
                    const osuaniElement = document.createElement('div');
                    osuaniElement.className = 'name-pair';
                    
                    const osuaniLabel = document.createElement('span');
                    osuaniLabel.className = 'name-label';
                    osuaniLabel.textContent = 'Osuani:';
                    
                    const osuaniValue = document.createElement('span');
                    osuaniValue.className = 'name-value';
                    osuaniValue.textContent = formattedNames.osuani;
                    
                    osuaniElement.appendChild(osuaniLabel);
                    osuaniElement.appendChild(osuaniValue);
                    
                    const boafoElement = document.createElement('div');
                    boafoElement.className = 'name-pair';
                    
                    const boafoLabel = document.createElement('span');
                    boafoLabel.className = 'name-label';
                    boafoLabel.textContent = 'Boafo:';
                    
                    const boafoValue = document.createElement('span');
                    boafoValue.className = 'name-value';
                    boafoValue.textContent = formattedNames.boafo;
                    
                    boafoElement.appendChild(boafoLabel);
                    boafoElement.appendChild(boafoValue);
                    
                    person.appendChild(osuaniElement);
                    person.appendChild(boafoElement);
                } else {
                    // Single name
                    const nameElement = document.createElement('div');
                    nameElement.className = 'person-name';
                    nameElement.textContent = formattedNames;
                    person.appendChild(nameElement);
                }
                
                roleContent.appendChild(person);
                roleCard.appendChild(roleHeader);
                roleCard.appendChild(roleContent);
                scheduleGrid.appendChild(roleCard);
            });
        }

        // Set up event listeners
        function setupEventListeners() {
            monthSelect.addEventListener('change', function() {
                currentMonth = this.value;
                currentWeekIndex = 0;
                updateWeekSelect();
                renderSchedule();
            });
            
            weekSelect.addEventListener('change', function() {
                currentWeekIndex = parseInt(this.value);
                updateWeekSelect();
                renderSchedule();
            });
            
            prevWeekBtn.addEventListener('click', function() {
                if (currentWeekIndex > 0) {
                    currentWeekIndex--;
                    updateWeekSelect();
                    renderSchedule();
                }
            });
            
            nextWeekBtn.addEventListener('click', function() {
                const month = NoticeData[currentMonth];
                if (currentWeekIndex < month.weeks.length - 1) {
                    currentWeekIndex++;
                    updateWeekSelect();
                    renderSchedule();
                }
            });
            
            // Guide event listeners
            guideToggle.addEventListener('click', showGuide);
            guideClose.addEventListener('click', hideGuide);
            guidePrev.addEventListener('click', prevGuideStep);
            guideNext.addEventListener('click', nextGuideStep);
            
            guideDots.forEach(dot => {
                dot.addEventListener('click', function() {
                    goToGuideStep(parseInt(this.dataset.step));
                });
            });
            
            // Close guide when clicking outside
            guideModal.addEventListener('click', function(e) {
                if (e.target === guideModal) {
                    hideGuide();
                }
            });
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>