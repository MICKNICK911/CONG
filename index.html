<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mid-Week Meeting Assignment Schedule</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --border-radius: 10px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: var(--dark-color);
            line-height: 1.6;
        }

        /* Splash Screen */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2c3e50, #3498db);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        #splash-screen h1 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-align: center;
            padding: 0 1rem;
        }

        #splash-screen p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.2rem;
        }

        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-top: 2rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 1.5rem 0;
            text-align: center;
            box-shadow: var(--box-shadow);
            margin-bottom: 1.5rem;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.8;
        }

        .current-date {
            background-color: var(--success-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            font-weight: bold;
            text-align: center;
            margin-bottom: 1rem;
            box-shadow: var(--box-shadow);
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
            background: white;
            padding: 1rem;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .month-selector, .week-selector {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }

        .month-selector select, .week-selector select {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            background-color: white;
        }

        .nav-buttons {
            display: flex;
            gap: 0.5rem;
        }

        button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 0.75rem 1rem;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }

        .current-week-indicator {
            background-color: var(--accent-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            font-weight: bold;
            text-align: center;
            margin-bottom: 1rem;
            display: none;
        }

        .current-week-indicator.active {
            display: block;
        }

        .schedule-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .role-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            transition: var(--transition);
        }

        .role-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .role-header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .role-content {
            padding: 1rem;
        }

        .person {
            padding: 0.75rem;
            border-bottom: 1px solid #eee;
            display: flex;
            flex-direction: column;
        }

        .person:last-child {
            border-bottom: none;
        }

        .person-name {
            white-space: pre-line;
        }

        .name-pair {
            margin-bottom: 0.5rem;
        }

        .name-label {
            font-weight: bold;
            color: var(--primary-color);
            margin-right: 0.5rem;
        }

        .name-value {
            color: var(--dark-color);
        }

        .empty-slot {
            color: #95a5a6;
            font-style: italic;
        }

        footer {
            text-align: center;
            margin-top: 2rem;
            padding: 1rem;
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        /* User Guide Styles */
        .user-guide {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .guide-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: var(--transition);
        }

        .guide-toggle:hover {
            transform: scale(1.1);
            background-color: #2980b9;
        }

        .guide-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .guide-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .guide-content {
            background-color: white;
            width: 90%;
            max-width: 600px;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform: translateY(20px);
            transition: var(--transition);
        }

        .guide-modal.active .guide-content {
            transform: translateY(0);
        }

        .guide-header {
            background-color: var(--primary-color);
            color: white;
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .guide-header h2 {
            margin: 0;
        }

        .guide-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .guide-body {
            padding: 1.5rem;
            max-height: 60vh;
            overflow-y: auto;
        }

        .guide-step {
            margin-bottom: 2rem;
            display: none;
        }

        .guide-step.active {
            display: block;
        }

        .guide-step h3 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .guide-step p {
            margin-bottom: 1rem;
        }

        .guide-step-image {
            background-color: var(--light-color);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
            font-style: italic;
            color: var(--dark-color);
        }

        .guide-navigation {
            display: flex;
            justify-content: space-between;
            padding: 1rem 1.5rem;
            border-top: 1px solid #eee;
        }

        .guide-dots {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            align-items: center;
        }

        .guide-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #ddd;
            cursor: pointer;
            transition: var(--transition);
        }

        .guide-dot.active {
            background-color: var(--secondary-color);
        }

        .guide-feature-highlight {
            background-color: rgba(52, 152, 219, 0.1);
            border: 1px dashed var(--secondary-color);
            border-radius: var(--border-radius);
            padding: 0.5rem;
            margin: 0.5rem 0;
        }

        /* Desktop styles */
        @media (min-width: 768px) {
            .controls {
                flex-direction: row;
                align-items: center;
            }
            
            .month-selector, .week-selector {
                flex: 1;
            }
            
            .schedule-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .schedule-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div id="splash-screen">
        <h1>üìñ Meeting Work Book Assignment Schedule</h1>
        <p>Loading your assignments...</p>
        <div class="loader"></div>
    </div>

    <!-- Main App -->
    <div id="app" style="display: none;">
        <header>
            <div class="container">
                <h1>üìÖ Mid-Week Meeting Assignment Schedule</h1>
                <div class="subtitle">View weekly assignments and responsibilities</div>
            </div>
        </header>

        <div class="container">
            <div id="current-date" class="current-date">
                <!-- Current date will be populated by JavaScript -->
            </div>

            <div class="controls">
                <div class="month-selector">
                    <label for="month-select">üìÖ Month:</label>
                    <select id="month-select">
                        <!-- Months will be populated by JavaScript -->
                    </select>
                </div>
                
                <div class="week-selector">
                    <label for="week-select">üìÜ Week:</label>
                    <select id="week-select">
                        <!-- Weeks will be populated by JavaScript -->
                    </select>
                </div>
                
                <div class="nav-buttons">
                    <button id="prev-week" disabled>
                        ‚óÄÔ∏è
                    </button>
                    <button id="next-week">
                        ‚ñ∂Ô∏è
                    </button>
                </div>
            </div>

            <div id="current-week-indicator" class="current-week-indicator">
                üü¢ This is the current week
            </div>

            <div id="schedule-grid" class="schedule-grid">
                <!-- Schedule will be populated by JavaScript -->
            </div>
        </div>

        <footer>
            <div class="container">
                <p>Mid-Week Meeting Assignment Schedule &copy; 2025</p>
            </div>
        </footer>
    </div>

    <!-- User Guide -->
    <div class="user-guide">
        <button class="guide-toggle">?</button>
    </div>

    <!-- Guide Modal -->
    <div class="guide-modal">
        <div class="guide-content">
            <div class="guide-header">
                <h2>üìñ How to Use This App</h2>
                <button class="guide-close">√ó</button>
            </div>
            <div class="guide-body">
                <div class="guide-step active" id="step-1">
                    <h3>üëã Welcome!</h3>
                    <p>This app helps you view meeting assignments for each week. Let's take a quick tour of the features.</p>
                    <div class="guide-step-image">
                        üìÖ Meeting Assignment Schedule
                    </div>
                    <p>You can always access this guide by clicking the <strong>?</strong> button in the bottom right corner.</p>
                </div>
                
                <div class="guide-step" id="step-2">
                    <h3>üìÖ Month Selection</h3>
                    <p>Use the <strong>Month dropdown</strong> to navigate between different months.</p>
                    <div class="guide-feature-highlight">
                        <strong>Try it:</strong> Select a different month to see assignments for that period
                    </div>
                    <p>The app contains schedules from July to December 2025.</p>
                </div>
                
                <div class="guide-step" id="step-3">
                    <h3>üìÜ Week Selection</h3>
                    <p>Use the <strong>Week dropdown</strong> to view assignments for specific weeks within the selected month.</p>
                    <div class="guide-feature-highlight">
                        <strong>Tip:</strong> Each month has 4-5 weeks of assignments
                    </div>
                    <p>You can also use the <strong>‚óÄÔ∏è ‚ñ∂Ô∏è navigation buttons</strong> to move between weeks quickly.</p>
                </div>
                
                <div class="guide-step" id="step-4">
                    <h3>üü¢ Current Week Indicator</h3>
                    <p>When viewing the current week, you'll see a green indicator at the top.</p>
                    <div class="guide-step-image">
                        üü¢ This is the current week
                    </div>
                    <p>This helps you quickly identify which assignments are for this week's meeting.</p>
                </div>
                
                <div class="guide-step" id="step-5">
                    <h3>üë• Assignment Cards</h3>
                    <p>Each role is displayed in a separate card with the assigned person's name.</p>
                    <div class="guide-step-image">
                        <strong>Bible Reading:</strong><br>
                        John Doe
                    </div>
                    <p>For assignments with two people, you'll see both <strong>Osuani</strong> (Main) and <strong>Boafo</strong> (Assistant) roles.</p>
                </div>
                
                <div class="guide-step" id="step-6">
                    <h3>üéØ You're All Set!</h3>
                    <p>You now know how to use all the features of the Meeting Assignment Schedule.</p>
                    <div class="guide-feature-highlight">
                        <strong>Remember:</strong> The app automatically shows the current week's assignments when you first open it
                    </div>
                    <p>If you need help again, just click the <strong>?</strong> button anytime!</p>
                </div>
            </div>
            <div class="guide-navigation">
                <button id="guide-prev" disabled>Previous</button>
                <div class="guide-dots">
                    <div class="guide-dot active" data-step="1"></div>
                    <div class="guide-dot" data-step="2"></div>
                    <div class="guide-dot" data-step="3"></div>
                    <div class="guide-dot" data-step="4"></div>
                    <div class="guide-dot" data-step="5"></div>
                    <div class="guide-dot" data-step="6"></div>
                </div>
                <button id="guide-next">Next</button>
            </div>
        </div>
    </div>
    <script src="mwb-notice/mwb-content.js"></script>
    <script>
        // Using the exact data provided
        const NoticeDataDB = NoticeData


        // App state
        let currentMonth = '';
        let currentWeekIndex = 0;
        let currentGuideStep = 1;
        const totalGuideSteps = 6;

        // DOM elements
        const splashScreen = document.getElementById('splash-screen');
        const app = document.getElementById('app');
        const currentDateElement = document.getElementById('current-date');
        const monthSelect = document.getElementById('month-select');
        const weekSelect = document.getElementById('week-select');
        const prevWeekBtn = document.getElementById('prev-week');
        const nextWeekBtn = document.getElementById('next-week');
        const currentWeekIndicator = document.getElementById('current-week-indicator');
        const scheduleGrid = document.getElementById('schedule-grid');

        // Guide elements
        const guideToggle = document.querySelector('.guide-toggle');
        const guideModal = document.querySelector('.guide-modal');
        const guideClose = document.querySelector('.guide-close');
        const guidePrev = document.getElementById('guide-prev');
        const guideNext = document.getElementById('guide-next');
        const guideDots = document.querySelectorAll('.guide-dot');

        // Role name mapping
        const roleNameMap = {
            "1": "Bible Mu Akorade",
            "2": "Tweetwee Bible Mu", 
            "3": "Bible Akenkan",
            "Chairman": "Chairman",
            "Opening Prayer": "Opening Prayer",
            "Closing Prayer": "Closing Prayer"
        };

        // Initialize the app
        function init() {
            // Show splash screen for 3 seconds
            setTimeout(() => {
                splashScreen.style.opacity = '0';
                setTimeout(() => {
                    splashScreen.style.display = 'none';
                    app.style.display = 'block';
                    
                    // Show guide for first-time users
                    const hasSeenGuide = localStorage.getItem('hasSeenGuide');
                    if (!hasSeenGuide) {
                        setTimeout(() => {
                            showGuide();
                            localStorage.setItem('hasSeenGuide', 'true');
                        }, 1000);
                    }
                }, 500);
            }, 3000);

            // Find current week based on 2025 date
            findCurrentWeek();
            
            // Update current date
            updateCurrentDate();
            
            // Initialize the rest of the app
            populateMonthSelect();
            updateWeekSelect();
            renderSchedule();
            setupEventListeners();
            
            // Update date every 60 minute
            setInterval(updateCurrentDate, 3600000);
        }

        // Guide functions
        function showGuide() {
            guideModal.classList.add('active');
            currentGuideStep = 1;
            updateGuide();
        }

        function hideGuide() {
            guideModal.classList.remove('active');
        }

        function updateGuide() {
            // Hide all steps
            document.querySelectorAll('.guide-step').forEach(step => {
                step.classList.remove('active');
            });
            
            // Show current step
            document.getElementById(`step-${currentGuideStep}`).classList.add('active');
            
            // Update dots
            guideDots.forEach(dot => {
                dot.classList.remove('active');
                if (parseInt(dot.dataset.step) === currentGuideStep) {
                    dot.classList.add('active');
                }
            });
            
            // Update button states
            guidePrev.disabled = currentGuideStep === 1;
            guideNext.textContent = currentGuideStep === totalGuideSteps ? 'Finish' : 'Next';
        }

        function nextGuideStep() {
            if (currentGuideStep < totalGuideSteps) {
                currentGuideStep++;
                updateGuide();
            } else {
                hideGuide();
            }
        }

        function prevGuideStep() {
            if (currentGuideStep > 1) {
                currentGuideStep--;
                updateGuide();
            }
        }

        function goToGuideStep(step) {
            currentGuideStep = step;
            updateGuide();
        }

        // Get current date (using actual date for real-time updates)
        function getCurrentDate() {
            return new Date();
        }

        // Parse week range to extract start and end dates
        function parseWeekRange(weekRange) {
            const parts = weekRange.split(' - ');
            if (parts.length !== 2) return null;
            
            const startStr = parts[0].trim();
            const endStr = parts[1].trim();
            
            // Parse start date
            const startParts = startStr.split(' ');
            const startMonth = startParts[0];
            const startDay = parseInt(startParts[1]);
            
            // Parse end date
            const endParts = endStr.split(' ');
            let endMonth, endDay;
            
            if (endParts.length === 2) {
                // End date has month and day (e.g., "October 5")
                endMonth = endParts[0];
                endDay = parseInt(endParts[1]);
            } else {
                // End date only has day (same month as start)
                endMonth = startMonth;
                endDay = parseInt(endParts[0]);
            }
            
            // Convert month names to numbers (0-11)
            const monthNames = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];
            
            const startMonthIndex = monthNames.indexOf(startMonth);
            const endMonthIndex = monthNames.indexOf(endMonth);
            
            if (startMonthIndex === -1 || endMonthIndex === -1) return null;
            
            // Create date objects (using 2025 as the year)
            const startDate = new Date(2025, startMonthIndex, startDay);
            const endDate = new Date(2025, endMonthIndex, endDay);
            
            // If end date is before start date, it means we're spanning across years
            // This shouldn't happen in our 2025 data, but handle it just in case
            if (endDate < startDate) {
                endDate.setFullYear(2026);
            }
            
            return { startDate, endDate };
        }

        // Find current week based on current date
        function findCurrentWeek() {
            const currentDate = getCurrentDate();
            
            // Try to find the current week in all months
            for (const monthId in NoticeDataDB) {
                const month = NoticeDataDB[monthId];
                
                for (let weekIndex = 0; weekIndex < month.weeks.length; weekIndex++) {
                    const week = month.weeks[weekIndex];
                    const dateRange = parseWeekRange(week.range);
                    
                    if (!dateRange) continue;
                    
                    const { startDate, endDate } = dateRange;
                    
                    // Check if current date falls within this week
                    if (currentDate >= startDate && currentDate <= endDate) {
                        currentMonth = monthId;
                        currentWeekIndex = weekIndex;
                        return;
                    }
                }
            }
            
            // If no current week found, check for isCurrent flag
            for (const monthId in NoticeDataDB) {
                const month = NoticeDataDB[monthId];
                const currentWeek = month.weeks.findIndex(week => week.isCurrent);
                if (currentWeek !== -1) {
                    currentMonth = monthId;
                    currentWeekIndex = currentWeek;
                    return;
                }
            }
            
            // Final fallback: use first month and first week
            const firstMonth = Object.values(NoticeDataDB)[0];
            currentMonth = firstMonth.id;
            currentWeekIndex = 0;
        }

        // Update current date display
        function updateCurrentDate() {
            const currentDate = getCurrentDate();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            currentDateElement.textContent = `üìÖ ${currentDate.toLocaleDateString('en-US', options)}`;
            
            // Check if we need to update the current week
            const previousMonth = currentMonth;
            const previousWeekIndex = currentWeekIndex;
            
            findCurrentWeek();
            
            // If the current week has changed, update the UI
            if (previousMonth !== currentMonth || previousWeekIndex !== currentWeekIndex) {
                updateWeekSelect();
                renderSchedule();
            }
        }

        // Populate month dropdown
        function populateMonthSelect() {
            monthSelect.innerHTML = '';
            
            Object.values(NoticeDataDB).forEach(month => {
                const option = document.createElement('option');
                option.value = month.id;
                option.textContent = month.name;
                monthSelect.appendChild(option);
            });
            
            monthSelect.value = currentMonth;
        }

        // Update week dropdown based on selected month
        function updateWeekSelect() {
            weekSelect.innerHTML = '';
            const month = NoticeDataDB[currentMonth];
            
            month.weeks.forEach((week, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = week.range;
                weekSelect.appendChild(option);
            });
            
            weekSelect.value = currentWeekIndex;
            
            // Update navigation buttons state
            prevWeekBtn.disabled = currentWeekIndex === 0;
            nextWeekBtn.disabled = currentWeekIndex === month.weeks.length - 1;
            
            // Show current week indicator if this is the current week
            const currentDate = getCurrentDate();
            const monthData = NoticeDataDB[currentMonth];
            const week = monthData.weeks[currentWeekIndex];
            const dateRange = parseWeekRange(week.range);
            
            let isCurrentWeek = false;
            if (dateRange) {
                const { startDate, endDate } = dateRange;
                isCurrentWeek = (currentDate >= startDate && currentDate <= endDate);
            }
            
            currentWeekIndicator.classList.toggle('active', isCurrentWeek);
        }

        // Format names with "&" to use Osuani/Boafo format
        function formatNames(text) {
            if (text.includes('&')) {
                const parts = text.split('&').map(part => part.trim());
                if (parts.length === 2) {
                    return {
                        osuani: parts[0],
                        boafo: parts[1]
                    };
                }
            }
            return text;
        }

        // Get display name for role
        function getRoleDisplayName(roleName) {
            // Check if role has a custom display name
            if (roleNameMap[roleName]) {
                return roleNameMap[roleName];
            }
            
            // Check if role is a number (for Dwumadi roles)
            if (!isNaN(roleName) && parseInt(roleName) > 3) {
                const roleNum = parseInt(roleName);
                const month = NoticeDataDB[currentMonth];
                const numericRoles = Object.keys(month.roles)
                    .filter(key => !isNaN(key) && month.roles[key][currentWeekIndex].text)
                    .map(Number)
                    .sort((a, b) => a - b);
                
                // Check if this is the last numeric role
                if (roleNum === numericRoles[numericRoles.length - 1]) {
                    return "Asafo Bible Adesua";
                } else {
                    return `Dwumadi ${roleNum}`;
                }
            }
            
            // Default: return the original role name
            return roleName;
        }

        // Render the schedule for the selected week
        function renderSchedule() {
            scheduleGrid.innerHTML = '';
            const month = NoticeDataDB[currentMonth];
            const roles = month.roles;
            
            // Get all role names and sort them in the required order
            const roleNames = Object.keys(roles);
            
            // Sort roles in the required order
            const sortedRoleNames = roleNames.sort((a, b) => {
                const order = [
                    "Chairman",
                    "Opening Prayer",
                    "1", "2", "3"  // These will be renamed
                ];
                
                // Add numeric roles (4 and above)
                const numericRoles = roleNames
                    .filter(name => !isNaN(name) && parseInt(name) > 3 && roles[name][currentWeekIndex].text)
                    .map(Number)
                    .sort((a, b) => a - b)
                    .map(String);
                
                // Add closing prayer at the end
                order.push(...numericRoles, "Closing Prayer");
                
                return order.indexOf(a) - order.indexOf(b);
            });
            
            // Render each role
            sortedRoleNames.forEach(roleName => {
                const assignment = roles[roleName][currentWeekIndex];
                
                // Skip roles with no assignment
                if (!assignment.text) return;
                
                const roleCard = document.createElement('div');
                roleCard.className = 'role-card';
                
                const roleHeader = document.createElement('div');
                roleHeader.className = 'role-header';
                roleHeader.textContent = getRoleDisplayName(roleName);
                
                const roleContent = document.createElement('div');
                roleContent.className = 'role-content';
                
                const person = document.createElement('div');
                person.className = 'person';
                
                const formattedNames = formatNames(assignment.text);
                
                if (typeof formattedNames === 'object') {
                    // Create Osuani and Boafo elements with styling
                    const osuaniElement = document.createElement('div');
                    osuaniElement.className = 'name-pair';
                    
                    const osuaniLabel = document.createElement('span');
                    osuaniLabel.className = 'name-label';
                    osuaniLabel.textContent = 'Osuani:';
                    
                    const osuaniValue = document.createElement('span');
                    osuaniValue.className = 'name-value';
                    osuaniValue.textContent = formattedNames.osuani;
                    
                    osuaniElement.appendChild(osuaniLabel);
                    osuaniElement.appendChild(osuaniValue);
                    
                    const boafoElement = document.createElement('div');
                    boafoElement.className = 'name-pair';
                    
                    const boafoLabel = document.createElement('span');
                    boafoLabel.className = 'name-label';
                    boafoLabel.textContent = 'Boafo:';
                    
                    const boafoValue = document.createElement('span');
                    boafoValue.className = 'name-value';
                    boafoValue.textContent = formattedNames.boafo;
                    
                    boafoElement.appendChild(boafoLabel);
                    boafoElement.appendChild(boafoValue);
                    
                    person.appendChild(osuaniElement);
                    person.appendChild(boafoElement);
                } else {
                    // Single name
                    const nameElement = document.createElement('div');
                    nameElement.className = 'person-name';
                    nameElement.textContent = formattedNames;
                    person.appendChild(nameElement);
                }
                
                roleContent.appendChild(person);
                roleCard.appendChild(roleHeader);
                roleCard.appendChild(roleContent);
                scheduleGrid.appendChild(roleCard);
            });
        }

        // Set up event listeners
        function setupEventListeners() {
            monthSelect.addEventListener('change', function() {
                currentMonth = this.value;
                currentWeekIndex = 0;
                updateWeekSelect();
                renderSchedule();
            });
            
            weekSelect.addEventListener('change', function() {
                currentWeekIndex = parseInt(this.value);
                updateWeekSelect();
                renderSchedule();
            });
            
            prevWeekBtn.addEventListener('click', function() {
                if (currentWeekIndex > 0) {
                    currentWeekIndex--;
                    updateWeekSelect();
                    renderSchedule();
                }
            });
            
            nextWeekBtn.addEventListener('click', function() {
                const month = NoticeDataDB[currentMonth];
                if (currentWeekIndex < month.weeks.length - 1) {
                    currentWeekIndex++;
                    updateWeekSelect();
                    renderSchedule();
                }
            });
            
            // Guide event listeners
            guideToggle.addEventListener('click', showGuide);
            guideClose.addEventListener('click', hideGuide);
            guidePrev.addEventListener('click', prevGuideStep);
            guideNext.addEventListener('click', nextGuideStep);
            
            guideDots.forEach(dot => {
                dot.addEventListener('click', function() {
                    goToGuideStep(parseInt(this.dataset.step));
                });
            });
            
            // Close guide when clicking outside
            guideModal.addEventListener('click', function(e) {
                if (e.target === guideModal) {
                    hideGuide();
                }
            });
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>