<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mid-Week Meeting Assignment Schedule</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --border-radius: 10px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: var(--dark-color);
            line-height: 1.6;
        }

        /* Splash Screen */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2c3e50, #3498db);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        #splash-screen h1 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-align: center;
            padding: 0 1rem;
        }

        #splash-screen p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.2rem;
        }

        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-top: 2rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 1.5rem 0;
            text-align: center;
            box-shadow: var(--box-shadow);
            margin-bottom: 1.5rem;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.8;
        }

        .current-date {
            background-color: var(--success-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            font-weight: bold;
            text-align: center;
            margin-bottom: 1rem;
            box-shadow: var(--box-shadow);
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
            background: white;
            padding: 1rem;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .month-selector, .week-selector {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }

        .month-selector select, .week-selector select {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            background-color: white;
        }

        .nav-buttons {
            display: flex;
            gap: 0.5rem;
        }

        button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 0.75rem 1rem;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
            transform: none;
        }

        .current-week-indicator {
            background-color: var(--accent-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            font-weight: bold;
            text-align: center;
            margin-bottom: 1rem;
            display: none;
        }

        .current-week-indicator.active {
            display: block;
        }

        .schedule-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .role-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            transition: var(--transition);
        }

        .role-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .role-header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .role-content {
            padding: 1rem;
        }

        .person {
            padding: 0.75rem;
            border-bottom: 1px solid #eee;
            display: flex;
            flex-direction: column;
        }

        .person:last-child {
            border-bottom: none;
        }

        .person-name {
            white-space: pre-line;
        }

        .name-pair {
            margin-bottom: 0.5rem;
        }

        .name-label {
            font-weight: bold;
            color: var(--primary-color);
            margin-right: 0.5rem;
        }

        .name-value {
            color: var(--dark-color);
        }

        .empty-slot {
            color: #95a5a6;
            font-style: italic;
        }

        footer {
            text-align: center;
            margin-top: 2rem;
            padding: 1rem;
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        /* Desktop styles */
        @media (min-width: 768px) {
            .controls {
                flex-direction: row;
                align-items: center;
            }
            
            .month-selector, .week-selector {
                flex: 1;
            }
            
            .schedule-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .schedule-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div id="splash-screen">
        <h1>üìñ Meeting Work Book Assignment Schedule</h1>
        <p>Loading your assignments...</p>
        <div class="loader"></div>
    </div>

    <!-- Main App -->
    <div id="app" style="display: none;">
        <header>
            <div class="container">
                <h1>üìÖ Mid-Week Meeting Assignment Schedule</h1>
                <div class="subtitle">View weekly assignments and responsibilities</div>
            </div>
        </header>

        <div class="container">
            <div id="current-date" class="current-date">
                <!-- Current date will be populated by JavaScript -->
            </div>

            <div class="controls">
                <div class="month-selector">
                    <label for="month-select">üìÖ Month:</label>
                    <select id="month-select">
                        <!-- Months will be populated by JavaScript -->
                    </select>
                </div>
                
                <div class="week-selector">
                    <label for="week-select">üìÜ Week:</label>
                    <select id="week-select">
                        <!-- Weeks will be populated by JavaScript -->
                    </select>
                </div>
                
                <div class="nav-buttons">
                    <button id="prev-week" disabled>
                        ‚óÄÔ∏è
                    </button>
                    <button id="next-week">
                        ‚ñ∂Ô∏è
                    </button>
                </div>
            </div>

            <div id="current-week-indicator" class="current-week-indicator">
                üü¢ This is the current week
            </div>

            <div id="schedule-grid" class="schedule-grid">
                <!-- Schedule will be populated by JavaScript -->
            </div>
        </div>

        <footer>
            <div class="container">
                <p>Mid-Week Meeting Assignment Schedule &copy; 2025</p>
            </div>
        </footer>
    </div>

    <script>
        // Using the exact data provided
        const NoticeData = {
            "july": {
                "id": "july",
                "name": "July 2025",
                "weeks": [
                    {
                        "range": "July 7 - 13",
                        "isCurrent": false
                    },
                    {
                        "range": "July 14 - 20",
                        "isCurrent": false
                    },
                    {
                        "range": "July 21 - 27",
                        "isCurrent": false
                    },
                    {
                        "range": "July 28 - 31",
                        "isCurrent": false
                    }
                ],
                "roles": {
                    "1": [
                        {
                            "text": "Emmanuel Asante",
                            "edited": false
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": false
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": false
                        },
                        {
                            "text": "Alexander Bawuah",
                            "edited": false
                        }
                    ],
                    "2": [
                        {
                            "text": "Hilkiah Entsie",
                            "edited": false
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": false
                        },
                        {
                            "text": "Isaac Ampomah",
                            "edited": false
                        },
                        {
                            "text": "Ephraim Sam",
                            "edited": false
                        }
                    ],
                    "3": [
                        {
                            "text": "Michael Obeng",
                            "edited": false
                        },
                        {
                            "text": "Stanley Yamekpe",
                            "edited": false
                        },
                        {
                            "text": "John Essel",
                            "edited": false
                        },
                        {
                            "text": "Frank Essah",
                            "edited": false
                        }
                    ],
                    "4": [
                        {
                            "text": "Christiana Amponsah & Margaret Entsie",
                            "edited": false
                        },
                        {
                            "text": "Barbara Asamoah & Lois Fosu",
                            "edited": false
                        },
                        {
                            "text": "Dorah Asare & Victoria Yeboah",
                            "edited": false
                        },
                        {
                            "text": "Lilian Ankomah & Rosina Yankson",
                            "edited": false
                        }
                    ],
                    "5": [
                        {
                            "text": "Rebecca Agbenyo & Mercy Entsie",
                            "edited": false
                        },
                        {
                            "text": "Selina Gyamfi & Barbara Amponsah",
                            "edited": false
                        },
                        {
                            "text": "Nhyira Appiah & Jemimah Miezah",
                            "edited": false
                        },
                        {
                            "text": "Dzifa Alonya & Vivian Arhin",
                            "edited": false
                        }
                    ],
                    "6": [
                        {
                            "text": "Nancy Baidoo & Tracy Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Paul Asiedu",
                            "edited": false
                        },
                        {
                            "text": "Reuben Sowolo & Francis Entsie",
                            "edited": false
                        },
                        {
                            "text": "Lois Sowolo & Alimatu Sadia",
                            "edited": false
                        }
                    ],
                    "7": [
                        {
                            "text": "Abel Eshun",
                            "edited": false
                        },
                        {
                            "text": "Alexander Bawuah",
                            "edited": false
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": false
                        },
                        {
                            "text": "Isaac Arhin",
                            "edited": false
                        }
                    ],
                    "8": [
                        {
                            "text": "Michael Appiah",
                            "edited": false
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": false
                        },
                        {
                            "text": "Ahiade",
                            "edited": false
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": false
                        }
                    ],
                    "9": [
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "Derrick Yankson",
                            "edited": false
                        },
                        {
                            "text": "Arhin Kingsley",
                            "edited": false
                        }
                    ],
                    "Chairman": [
                        {
                            "text": "Derrick Yankson",
                            "edited": false
                        },
                        {
                            "text": "Anthony Entsie",
                            "edited": false
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": false
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": false
                        }
                    ],
                    "Opening Prayer": [
                        {
                            "text": "Emmanuel Entsie",
                            "edited": false
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": false
                        },
                        {
                            "text": "Isaac Arhin",
                            "edited": false
                        },
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": false
                        }
                    ],
                    "Closing Prayer": [
                        {
                            "text": "Dickson Onwona",
                            "edited": false
                        },
                        {
                            "text": "Isaac Ampomah",
                            "edited": false
                        },
                        {
                            "text": "Newton Sam",
                            "edited": false
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": false
                        }
                    ]
                },
                "copiedFrom": null
            },
            "august": {
                "id": "august",
                "name": "August 2025",
                "weeks": [
                    {
                        "range": "August 4 - 10",
                        "isCurrent": false
                    },
                    {
                        "range": "August 11 - 17",
                        "isCurrent": false
                    },
                    {
                        "range": "August 18 - 24",
                        "isCurrent": false
                    },
                    {
                        "range": "August 25 - 31",
                        "isCurrent": false
                    }
                ],
                "roles": {
                    "1": [
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": false
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": false
                        },
                        {
                            "text": "Michael Appiah",
                            "edited": false
                        },
                        {
                            "text": "Isaac Ampomah",
                            "edited": false
                        }
                    ],
                    "2": [
                        {
                            "text": "Obed Gyamfi",
                            "edited": false
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": false
                        },
                        {
                            "text": "Emmanuel Asante",
                            "edited": false
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": false
                        }
                    ],
                    "3": [
                        {
                            "text": "Stephen Essilfie",
                            "edited": false
                        },
                        {
                            "text": "Samuel Larbi",
                            "edited": false
                        },
                        {
                            "text": "Sadick Mohammed",
                            "edited": false
                        },
                        {
                            "text": "Ebenezer Normanyo",
                            "edited": false
                        }
                    ],
                    "4": [
                        {
                            "text": "Mawusi Appiah & Naomi Entsie",
                            "edited": false
                        },
                        {
                            "text": "Claudia Sam & Owusuwaa Appiah",
                            "edited": false
                        },
                        {
                            "text": "Joana Entsie & Gloria Adobea",
                            "edited": false
                        },
                        {
                            "text": "Mary Entsie & Adwoa Onwona",
                            "edited": false
                        }
                    ],
                    "5": [
                        {
                            "text": "Joana Ekwama & Adwoa Eshun",
                            "edited": false
                        },
                        {
                            "text": "Augusta Appiah & Mary Entsie",
                            "edited": false
                        },
                        {
                            "text": "Juliana Entsie & Adelaide Allotey",
                            "edited": false
                        },
                        {
                            "text": "Mercy Entsie & Cynthia Sam",
                            "edited": false
                        }
                    ],
                    "6": [
                        {
                            "text": "Shadrach Asare",
                            "edited": false
                        },
                        {
                            "text": "Foster Entsie & Ebenezer Normanyo",
                            "edited": false
                        },
                        {
                            "text": "Emmanuel Entsie",
                            "edited": false
                        },
                        {
                            "text": "Hannah & Claudia Polley",
                            "edited": false
                        }
                    ],
                    "7": [
                        {
                            "text": "Ahiade",
                            "edited": false
                        },
                        {
                            "text": "Ephraim Sam",
                            "edited": false
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": false
                        },
                        {
                            "text": "Abigail Asieduwaa & Elizabeth Yeboah",
                            "edited": false
                        }
                    ],
                    "8": [
                        {
                            "text": "Archibald Entsie",
                            "edited": false
                        },
                        {
                            "text": "Anthony Entsie",
                            "edited": false
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": false
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": false
                        }
                    ],
                    "9": [
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": false
                        }
                    ],
                    "10": [
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "Dickson Onwona",
                            "edited": false
                        }
                    ],
                    "Chairman": [
                        {
                            "text": "Dickson Onwona",
                            "edited": false
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": false
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": false
                        },
                        {
                            "text": "Kingsley Arhin",
                            "edited": false
                        }
                    ],
                    "Opening Prayer": [
                        {
                            "text": "Ephraim Sam",
                            "edited": false
                        },
                        {
                            "text": "Kingsley Arhin",
                            "edited": false
                        },
                        {
                            "text": "Derrick Yankson",
                            "edited": false
                        },
                        {
                            "text": "Emmanuel Asante",
                            "edited": false
                        }
                    ],
                    "Closing Prayer": [
                        {
                            "text": "Reuben Sowolo",
                            "edited": false
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": false
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": false
                        },
                        {
                            "text": "Isaac Arhin",
                            "edited": false
                        }
                    ]
                },
                "copiedFrom": null
            },
            "month_1755087963009": {
                "id": "month_1755087963009",
                "name": "September 2025",
                "weeks": [
                    {
                        "range": "September 1 - 7",
                        "isCurrent": false
                    },
                    {
                        "range": "September 8 - 14",
                        "isCurrent": false
                    },
                    {
                        "range": "September 15 - 21",
                        "isCurrent": false
                    },
                    {
                        "range": "September 22 - 28",
                        "isCurrent": false
                    },
                    {
                        "range": "September 29 - October 5",
                        "isCurrent": false
                    }
                ],
                "roles": {
                    "1": [
                        {
                            "text": "Daniel Boakye",
                            "edited": true
                        },
                        {
                            "text": "Arhin Kingsley",
                            "edited": true
                        },
                        {
                            "text": "Alexander Bawuah",
                            "edited": true
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": true
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        }
                    ],
                    "2": [
                        {
                            "text": "Samuel Onwona",
                            "edited": true
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": true
                        },
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": true
                        },
                        {
                            "text": "Ephraim Sam",
                            "edited": true
                        },
                        {
                            "text": "Emmanuel Asante",
                            "edited": true
                        }
                    ],
                    "3": [
                        {
                            "text": "Francis Entsie",
                            "edited": true
                        },
                        {
                            "text": "Jeromoth Arhin",
                            "edited": true
                        },
                        {
                            "text": "Frank Essah",
                            "edited": true
                        },
                        {
                            "text": "Sadick Mohammed",
                            "edited": true
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": true
                        }
                    ],
                    "4": [
                        {
                            "text": "Tracy Yeboah & Mercy Entsie",
                            "edited": true
                        },
                        {
                            "text": "Alimatu Saadia & Lois Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Owusuwaa Appiah & Margaret Entsie",
                            "edited": true
                        },
                        {
                            "text": "Victoria Yeboah & Naomi Entsie",
                            "edited": true
                        },
                        {
                            "text": "Elizabeth Yeboah & Lois Ofosu",
                            "edited": true
                        }
                    ],
                    "5": [
                        {
                            "text": "Naomi Entsie & Barbara Asamoah",
                            "edited": true
                        },
                        {
                            "text": "Gloria Adobea & Jemimah Miezah",
                            "edited": true
                        },
                        {
                            "text": "Perlita Gyamfua & Joana Ekwama Entsie",
                            "edited": true
                        },
                        {
                            "text": "Winifred Appiah  & Mary Entsie",
                            "edited": true
                        },
                        {
                            "text": "Jemimah Miezah & Joana Entsie",
                            "edited": true
                        }
                    ],
                    "6": [
                        {
                            "text": "Stephanie Onwona & Augusta Appiah",
                            "edited": true
                        },
                        {
                            "text": "Emmanuel Entsie",
                            "edited": true
                        },
                        {
                            "text": "Rosina Yankson & Nancy Baidoo",
                            "edited": true
                        },
                        {
                            "text": "Adwoa Onwona & Claudia Polley",
                            "edited": true
                        },
                        {
                            "text": "Paul Asiedu",
                            "edited": true
                        }
                    ],
                    "7": [
                        {
                            "text": "Ahiade",
                            "edited": true
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": true
                        },
                        {
                            "text": "Asuafo",
                            "edited": true
                        },
                        {
                            "text": "Alexander Bawuah",
                            "edited": true
                        }
                    ],
                    "8": [
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Nea Asafo Atumi Aye",
                            "edited": true
                        },
                        {
                            "text": "Ahiade",
                            "edited": true
                        },
                        {
                            "text": "Arhin Kingsley",
                            "edited": true
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        }
                    ],
                    "9": [
                        {
                            "text": "",
                            "edited": true
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        },
                        {
                            "text": "Dickson Onwona",
                            "edited": true
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": true
                        },
                        {
                            "text": "",
                            "edited": true
                        }
                    ],
                    "Chairman": [
                        {
                            "text": "Collins Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Michael Appiah",
                            "edited": true
                        },
                        {
                            "text": "Derrick Yankson",
                            "edited": true
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": true
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        }
                    ],
                    "Opening Prayer": [
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": true
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": true
                        },
                        {
                            "text": "Emmanuel Asante",
                            "edited": true
                        },
                        {
                            "text": "Michael Appiah",
                            "edited": true
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        }
                    ],
                    "Closing Prayer": [
                        {
                            "text": "Isaac Arhin",
                            "edited": true
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": true
                        },
                        {
                            "text": "Reuben Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Isaac Ampomah",
                            "edited": true
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": true
                        }
                    ]
                },
                "copiedFrom": "july"
            },
            "month_1755087993804": {
                "id": "month_1755087993804",
                "name": "October 2025",
                "weeks": [
                    {
                        "range": "October 6 - 12",
                        "isCurrent": false
                    },
                    {
                        "range": "October 13 - 19",
                        "isCurrent": false
                    },
                    {
                        "range": "October 20 - 26",
                        "isCurrent": true
                    },
                    {
                        "range": "October 27 - November 2",
                        "isCurrent": false
                    }
                ],
                "roles": {
                    "1": [
                        {
                            "text": "Ephraim Sam",
                            "edited": true
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Isaac Ampomah",
                            "edited": true
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": true
                        }
                    ],
                    "2": [
                        {
                            "text": "Isaac Ampomah",
                            "edited": true
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": true
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": true
                        }
                    ],
                    "3": [
                        {
                            "text": "Foster Entsie",
                            "edited": true
                        },
                        {
                            "text": "Jesse Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Asante Emmauel",
                            "edited": true
                        },
                        {
                            "text": "Reuben Sowolo",
                            "edited": true
                        }
                    ],
                    "4": [
                        {
                            "text": "Clara Prempeh & Lilian Ankomah",
                            "edited": true
                        },
                        {
                            "text": "Priscilla Essel & Esther Takie",
                            "edited": true
                        },
                        {
                            "text": "Selina Gyamfi & Abigail Asiedu",
                            "edited": true
                        },
                        {
                            "text": "Esther Ofori & Esther Takie",
                            "edited": true
                        }
                    ],
                    "5": [
                        {
                            "text": "Adelaide Allotey & Lois Ofosu",
                            "edited": true
                        },
                        {
                            "text": "Barbara Amponsah & Vivian Arhin",
                            "edited": true
                        },
                        {
                            "text": "Erica Sowolo & Claudia Sam",
                            "edited": true
                        },
                        {
                            "text": "Joana Entsie & Claudia Polley",
                            "edited": true
                        }
                    ],
                    "6": [
                        {
                            "text": "Cynthia Sam & Joana Ekwama Entsie",
                            "edited": true
                        },
                        {
                            "text": "Sis Atobora & Margaret Entsie",
                            "edited": true
                        },
                        {
                            "text": "Dorah Asare & Adwoa Eshun",
                            "edited": true
                        },
                        {
                            "text": "Isaac Arhin",
                            "edited": true
                        }
                    ],
                    "7": [
                        {
                            "text": "Rebecca Agbenyo & Hannah Adumoah",
                            "edited": true
                        },
                        {
                            "text": "Juliana Entsie & Mawusi Appiah",
                            "edited": true
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        },
                        {
                            "text": "Ahiade",
                            "edited": true
                        }
                    ],
                    "8": [
                        {
                            "text": "Collins Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Hilkiah Entsie",
                            "edited": true
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": true
                        },
                        {
                            "text": "Anthony Entsie",
                            "edited": true
                        }
                    ],
                    "9": [
                        {
                            "text": "Michael Appiah",
                            "edited": true
                        },
                        {
                            "text": "Derrick Yankson",
                            "edited": true
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": true
                        }
                    ],
                    "Opening Prayer": [
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Reuben Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Kingsley Arhin",
                            "edited": true
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": true
                        }
                    ],
                    "Chairman": [
                        {
                            "text": "Arhin Kingsley",
                            "edited": true
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        },
                        {
                            "text": "Dickson Onwona",
                            "edited": true
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        }
                    ],
                    "Closing Prayer": [
                        {
                            "text": "Dickson Onwona",
                            "edited": true
                        },
                        {
                            "text": "Paul Asiedu",
                            "edited": true
                        },
                        {
                            "text": "Ephraim Sam",
                            "edited": true
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        }
                    ]
                },
                "copiedFrom": "august"
            },
            "month_1760118057198": {
                "id": "month_1760118057198",
                "name": "November 2025",
                "weeks": [
                    {
                        "range": "November 3 - 9",
                        "isCurrent": false
                    },
                    {
                        "range": "November 10 - 16",
                        "isCurrent": false
                    },
                    {
                        "range": "November 17 - 23",
                        "isCurrent": false
                    },
                    {
                        "range": "November 24 - 30",
                        "isCurrent": false
                    }
                ],
                "roles": {
                    "1": [
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": true
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": true
                        }
                    ],
                    "2": [
                        {
                            "text": "Ephraim Sam",
                            "edited": true
                        },
                        {
                            "text": "Kingsley Arhin",
                            "edited": true
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": true
                        },
                        {
                            "text": "Isaac Ampomah",
                            "edited": true
                        }
                    ],
                    "3": [
                        {
                            "text": "Jeromoth Arhin",
                            "edited": true
                        },
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": true
                        },
                        {
                            "text": "Stanley Yamekpe",
                            "edited": true
                        },
                        {
                            "text": "Dickson Onwona",
                            "edited": true
                        }
                    ],
                    "4": [
                        {
                            "text": "Barbara Asamoah & Joana Entsie",
                            "edited": true
                        },
                        {
                            "text": "Hannah Adumoah & Cynthia Sam",
                            "edited": true
                        },
                        {
                            "text": "Mariama Mohammed & Jemimah Miezah",
                            "edited": true
                        },
                        {
                            "text": "Lilian Bawuah & Juliana Entsie",
                            "edited": true
                        }
                    ],
                    "5": [
                        {
                            "text": "Lois Ofosu & Owusuwaa Appiah",
                            "edited": true
                        },
                        {
                            "text": "Nhyira Appiah & Adwoa Onwona",
                            "edited": true
                        },
                        {
                            "text": "Abigail Asiedu & Dora Asare",
                            "edited": true
                        },
                        {
                            "text": "Mawusi Appiah & Mary Entsie",
                            "edited": true
                        }
                    ],
                    "6": [
                        {
                            "text": "Mary Entsie & Adelaide Allotey",
                            "edited": true
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": true
                        },
                        {
                            "text": "Margaret Entsie & Pricilla Essel",
                            "edited": true
                        },
                        {
                            "text": "Emmanuel Entsie",
                            "edited": true
                        }
                    ],
                    "7": [
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": true
                        },
                        {
                            "text": "Vivian Arhin & Claudia Sam",
                            "edited": true
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": true
                        }
                    ],
                    "8": [
                        {
                            "text": "Derrick Yankson",
                            "edited": true
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        },
                        {
                            "text": "Alexander Bawuah",
                            "edited": true
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        }
                    ],
                    "9": [
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "Michael Appiah",
                            "edited": true
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        },
                        {
                            "text": "",
                            "edited": true
                        }
                    ],
                    "Chairman": [
                        {
                            "text": "Anthony Entsie",
                            "edited": true
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": true
                        }
                    ],
                    "Opening Prayer": [
                        {
                            "text": "Emmanuel Asante",
                            "edited": true
                        },
                        {
                            "text": "Reuben Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Anthony Entsie",
                            "edited": true
                        },
                        {
                            "text": "Michael Appiah",
                            "edited": true
                        }
                    ],
                    "Closing Prayer": [
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Emmanuel Entsie",
                            "edited": true
                        },
                        {
                            "text": "Isaac Arhin",
                            "edited": true
                        },
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": true
                        }
                    ]
                },
                "copiedFrom": "month_1755087963009"
            },
            "month_1760118260050": {
                "id": "month_1760118260050",
                "name": "December 2025",
                "weeks": [
                    {
                        "range": "December 1 - 7",
                        "isCurrent": false
                    },
                    {
                        "range": "December 8 - 14",
                        "isCurrent": false
                    },
                    {
                        "range": "December 15 - 21",
                        "isCurrent": false
                    },
                    {
                        "range": "December 22 - 28",
                        "isCurrent": false
                    },
                    {
                        "range": "December 29 - January 4",
                        "isCurrent": false
                    }
                ],
                "roles": {
                    "1": [
                        {
                            "text": "Alexander Bawuah",
                            "edited": true
                        },
                        {
                            "text": "Emmanuel Asante",
                            "edited": true
                        },
                        {
                            "text": "Derrick Yankson",
                            "edited": true
                        },
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        },
                        {
                            "text": "Anthony Entsie",
                            "edited": true
                        }
                    ],
                    "2": [
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Daniel Boakye",
                            "edited": true
                        },
                        {
                            "text": "Michael Appiah",
                            "edited": true
                        },
                        {
                            "text": "Hilkiah Kwakye",
                            "edited": true
                        }
                    ],
                    "3": [
                        {
                            "text": "Ebenezer Normanyo",
                            "edited": true
                        },
                        {
                            "text": "Jonathan Arthur",
                            "edited": true
                        },
                        {
                            "text": "Ephraim Sam",
                            "edited": true
                        },
                        {
                            "text": "Samuel Larbi",
                            "edited": true
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": true
                        }
                    ],
                    "4": [
                        {
                            "text": "Gloria Adobea & Juliana Entsie",
                            "edited": true
                        },
                        {
                            "text": "Christiana Amponsah & Adwoa Onwona",
                            "edited": true
                        },
                        {
                            "text": "Alimatu Saadia & Lois Soworlo",
                            "edited": true
                        },
                        {
                            "text": "Mercy Entsie & Rebecca Abgenyo",
                            "edited": true
                        },
                        {
                            "text": "Erica Sowolo & Rosina Yankson",
                            "edited": true
                        }
                    ],
                    "5": [
                        {
                            "text": "Naomi Entsie & Tracy Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Perlita Gyamfua & Joana Entsie",
                            "edited": true
                        },
                        {
                            "text": "Cynthia Sam & Stephanie Onwona",
                            "edited": true
                        },
                        {
                            "text": "Dorah Asare & Nancy Baidoo",
                            "edited": true
                        },
                        {
                            "text": "Claudia Sam & Sis Atobora",
                            "edited": true
                        }
                    ],
                    "6": [
                        {
                            "text": "Esther Takie & Selina Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Adwoa Eshun & Victoria Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Joana E. Entsie & Elizabeth Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Augusta Appiah & Winifred Appiah",
                            "edited": true
                        },
                        {
                            "text": "Paul Asiedu",
                            "edited": true
                        }
                    ],
                    "7": [
                        {
                            "text": "Ahiade - 15",
                            "edited": true
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": true
                        },
                        {
                            "text": "Shadrach Asare",
                            "edited": true
                        },
                        {
                            "text": "Collins Yeboah",
                            "edited": true
                        },
                        {
                            "text": "Ahiade - 15",
                            "edited": true
                        }
                    ],
                    "8": [
                        {
                            "text": "Circuit Overseer First Talk",
                            "edited": true
                        },
                        {
                            "text": "Isaac Newton",
                            "edited": true
                        },
                        {
                            "text": "Nea Asafo Aye",
                            "edited": true
                        },
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Dickson Onwona",
                            "edited": true
                        }
                    ],
                    "9": [
                        {
                            "text": "",
                            "edited": true
                        },
                        {
                            "text": "",
                            "edited": true
                        },
                        {
                            "text": "Anthony Entsie",
                            "edited": true
                        },
                        {
                            "text": "",
                            "edited": false
                        },
                        {
                            "text": "",
                            "edited": false
                        }
                    ],
                    "Opening Prayer": [
                        {
                            "text": "Abel Eshun",
                            "edited": true
                        },
                        {
                            "text": "Samuel Onwona",
                            "edited": true
                        },
                        {
                            "text": "Paul Asiedu",
                            "edited": true
                        },
                        {
                            "text": "Obed Gyamfi",
                            "edited": true
                        },
                        {
                            "text": "Kingsley Arhin",
                            "edited": true
                        }
                    ],
                    "Chairman": [
                        {
                            "text": "Wonder Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Dickson Onwona",
                            "edited": true
                        },
                        {
                            "text": "Kingsley Arhin",
                            "edited": true
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        },
                        {
                            "text": "Derrick Yankson",
                            "edited": true
                        }
                    ],
                    "Closing Prayer": [
                        {
                            "text": "Ephraim Sam",
                            "edited": true
                        },
                        {
                            "text": "Archibald Entsie",
                            "edited": true
                        },
                        {
                            "text": "Reuben Sowolo",
                            "edited": true
                        },
                        {
                            "text": "Alexander Bawuah",
                            "edited": true
                        },
                        {
                            "text": "Gideon Miezah",
                            "edited": true
                        }
                    ]
                },
                "copiedFrom": "month_1755087993804"
            }
        };

        // App state
        let currentMonth = '';
        let currentWeekIndex = 0;
        let currentWeekInfo = { monthId: '', weekIndex: -1 };

        // DOM elements
        const splashScreen = document.getElementById('splash-screen');
        const app = document.getElementById('app');
        const currentDateElement = document.getElementById('current-date');
        const monthSelect = document.getElementById('month-select');
        const weekSelect = document.getElementById('week-select');
        const prevWeekBtn = document.getElementById('prev-week');
        const nextWeekBtn = document.getElementById('next-week');
        const currentWeekIndicator = document.getElementById('current-week-indicator');
        const scheduleGrid = document.getElementById('schedule-grid');

        // Role name mapping
        const roleNameMap = {
            "1": "Bible Mu Akorade",
            "2": "Tweetwee Bible Mu", 
            "3": "Bible Akenkan",
            "Chairman": "Chairman",
            "Opening Prayer": "Opening Prayer",
            "Closing Prayer": "Closing Prayer"
        };

        // Initialize the app
        function init() {
            // Show splash screen for 3 seconds
            setTimeout(() => {
                splashScreen.style.opacity = '0';
                setTimeout(() => {
                    splashScreen.style.display = 'none';
                    app.style.display = 'block';
                }, 500);
            }, 3000);

            // Find current week based on real date
            findCurrentWeek();
            
            // Update current date
            updateCurrentDate();
            
            // Initialize the rest of the app
            populateMonthSelect();
            updateWeekSelect();
            renderSchedule();
            setupEventListeners();
            
            // Update date every minute
            setInterval(updateCurrentDate, 3600000);
        }

        // Find current week based on real date
        function findCurrentWeek() {
            const now = new Date();
            const currentDate = now.getDate();
            const currentMonthNum = now.getMonth() + 1; // JavaScript months are 0-indexed
            
            // Convert month number to name
            const monthNames = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];
            const currentMonthName = monthNames[currentMonthNum - 1];
            
            // Find the current month in our data
            let foundMonth = null;
            let foundWeekIndex = -1;
            
            // Look for exact month match first
            for (const monthId in NoticeData) {
                const month = NoticeData[monthId];
                if (month.name.includes(currentMonthName)) {
                    foundMonth = month;
                    break;
                }
            }
            
            // If we found the month, find the current week
            if (foundMonth) {
                foundMonth.weeks.forEach((week, index) => {
                    // Extract start and end dates from the range string
                    const rangeParts = week.range.split(' - ');
                    const startDate = parseInt(rangeParts[0].split(' ')[1]);
                    let endDate = parseInt(rangeParts[1].split(' ')[1]);
                    
                    // Handle case where end date might be in next month
                    if (isNaN(endDate)) {
                        endDate = parseInt(rangeParts[1]);
                    }
                    
                    // Check if current date falls within this week
                    if (currentDate >= startDate && currentDate <= endDate) {
                        foundWeekIndex = index;
                    }
                });
                
                if (foundWeekIndex !== -1) {
                    currentWeekInfo = {
                        monthId: foundMonth.id,
                        weekIndex: foundWeekIndex
                    };
                    currentMonth = foundMonth.id;
                    currentWeekIndex = foundWeekIndex;
                    return;
                }
            }
            
            // Fallback: use the data's isCurrent flag
            for (const monthId in NoticeData) {
                const month = NoticeData[monthId];
                const currentWeek = month.weeks.findIndex(week => week.isCurrent);
                if (currentWeek !== -1) {
                    currentWeekInfo = {
                        monthId: month.id,
                        weekIndex: currentWeek
                    };
                    currentMonth = month.id;
                    currentWeekIndex = currentWeek;
                    return;
                }
            }
            
            // Final fallback: use first month and first week
            const firstMonth = Object.values(NoticeData)[0];
            currentWeekInfo = {
                monthId: firstMonth.id,
                weekIndex: 0
            };
            currentMonth = firstMonth.id;
            currentWeekIndex = 0;
        }

        // Update current date display
        function updateCurrentDate() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            currentDateElement.textContent = `üìÖ ${now.toLocaleDateString('en-US', options)}`;
            
            // Check if we need to update the current week
            const currentDate = now.getDate();
            const currentMonthNum = now.getMonth() + 1;
            const monthNames = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];
            const currentMonthName = monthNames[currentMonthNum - 1];
            
            // Check if current week has changed
            const currentMonthData = NoticeData[currentMonth];
            if (currentMonthData && currentMonthData.name.includes(currentMonthName)) {
                const week = currentMonthData.weeks[currentWeekIndex];
                if (week) {
                    const rangeParts = week.range.split(' - ');
                    const startDate = parseInt(rangeParts[0].split(' ')[1]);
                    let endDate = parseInt(rangeParts[1].split(' ')[1]);
                    
                    if (isNaN(endDate)) {
                        endDate = parseInt(rangeParts[1]);
                    }
                    
                    // If current date is outside the current week range, find the correct week
                    if (currentDate < startDate || currentDate > endDate) {
                        findCurrentWeek();
                        updateWeekSelect();
                        renderSchedule();
                    }
                }
            }
        }

        // Populate month dropdown
        function populateMonthSelect() {
            monthSelect.innerHTML = '';
            
            Object.values(NoticeData).forEach(month => {
                const option = document.createElement('option');
                option.value = month.id;
                option.textContent = month.name;
                monthSelect.appendChild(option);
            });
            
            monthSelect.value = currentMonth;
        }

        // Update week dropdown based on selected month
        function updateWeekSelect() {
            weekSelect.innerHTML = '';
            const month = NoticeData[currentMonth];
            
            month.weeks.forEach((week, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = week.range;
                weekSelect.appendChild(option);
            });
            
            weekSelect.value = currentWeekIndex;
            
            // Update navigation buttons state
            prevWeekBtn.disabled = currentWeekIndex === 0;
            nextWeekBtn.disabled = currentWeekIndex === month.weeks.length - 1;
            
            // Show current week indicator if this is the current week
            const isCurrentWeek = currentWeekInfo && 
                                 currentMonth === currentWeekInfo.monthId && 
                                 currentWeekIndex === currentWeekInfo.weekIndex;
            currentWeekIndicator.classList.toggle('active', isCurrentWeek);
        }

        // Format names with "&" to use Osuani/Boafo format
        function formatNames(text) {
            if (text.includes('&')) {
                const parts = text.split('&').map(part => part.trim());
                if (parts.length === 2) {
                    return {
                        osuani: parts[0],
                        boafo: parts[1]
                    };
                }
            }
            return text;
        }

        // Get display name for role
        function getRoleDisplayName(roleName) {
            // Check if role has a custom display name
            if (roleNameMap[roleName]) {
                return roleNameMap[roleName];
            }
            
            // Check if role is a number (for Dwumadi roles)
            if (!isNaN(roleName) && parseInt(roleName) > 3) {
                const roleNum = parseInt(roleName);
                const month = NoticeData[currentMonth];
                const numericRoles = Object.keys(month.roles)
                    .filter(key => !isNaN(key) && month.roles[key][currentWeekIndex].text)
                    .map(Number)
                    .sort((a, b) => a - b);
                
                // Check if this is the last numeric role
                if (roleNum === numericRoles[numericRoles.length - 1]) {
                    return "Asafo Bible Adesua";
                } else {
                    return `Dwumadi ${roleNum}`;
                }
            }
            
            // Default: return the original role name
            return roleName;
        }

        // Render the schedule for the selected week
        function renderSchedule() {
            scheduleGrid.innerHTML = '';
            const month = NoticeData[currentMonth];
            const roles = month.roles;
            
            // Get all role names and sort them in the required order
            const roleNames = Object.keys(roles);
            
            // Sort roles in the required order
            const sortedRoleNames = roleNames.sort((a, b) => {
                const order = [
                    "Chairman",
                    "Opening Prayer",
                    "1", "2", "3"  // These will be renamed
                ];
                
                // Add numeric roles (4 and above)
                const numericRoles = roleNames
                    .filter(name => !isNaN(name) && parseInt(name) > 3 && roles[name][currentWeekIndex].text)
                    .map(Number)
                    .sort((a, b) => a - b)
                    .map(String);
                
                // Add closing prayer at the end
                order.push(...numericRoles, "Closing Prayer");
                
                return order.indexOf(a) - order.indexOf(b);
            });
            
            // Render each role
            sortedRoleNames.forEach(roleName => {
                const assignment = roles[roleName][currentWeekIndex];
                
                // Skip roles with no assignment
                if (!assignment.text) return;
                
                const roleCard = document.createElement('div');
                roleCard.className = 'role-card';
                
                const roleHeader = document.createElement('div');
                roleHeader.className = 'role-header';
                roleHeader.textContent = getRoleDisplayName(roleName);
                
                const roleContent = document.createElement('div');
                roleContent.className = 'role-content';
                
                const person = document.createElement('div');
                person.className = 'person';
                
                const formattedNames = formatNames(assignment.text);
                
                if (typeof formattedNames === 'object') {
                    // Create Osuani and Boafo elements with styling
                    const osuaniElement = document.createElement('div');
                    osuaniElement.className = 'name-pair';
                    
                    const osuaniLabel = document.createElement('span');
                    osuaniLabel.className = 'name-label';
                    osuaniLabel.textContent = 'Osuani:';
                    
                    const osuaniValue = document.createElement('span');
                    osuaniValue.className = 'name-value';
                    osuaniValue.textContent = formattedNames.osuani;
                    
                    osuaniElement.appendChild(osuaniLabel);
                    osuaniElement.appendChild(osuaniValue);
                    
                    const boafoElement = document.createElement('div');
                    boafoElement.className = 'name-pair';
                    
                    const boafoLabel = document.createElement('span');
                    boafoLabel.className = 'name-label';
                    boafoLabel.textContent = 'Boafo:';
                    
                    const boafoValue = document.createElement('span');
                    boafoValue.className = 'name-value';
                    boafoValue.textContent = formattedNames.boafo;
                    
                    boafoElement.appendChild(boafoLabel);
                    boafoElement.appendChild(boafoValue);
                    
                    person.appendChild(osuaniElement);
                    person.appendChild(boafoElement);
                } else {
                    // Single name
                    const nameElement = document.createElement('div');
                    nameElement.className = 'person-name';
                    nameElement.textContent = formattedNames;
                    person.appendChild(nameElement);
                }
                
                roleContent.appendChild(person);
                roleCard.appendChild(roleHeader);
                roleCard.appendChild(roleContent);
                scheduleGrid.appendChild(roleCard);
            });
        }

        // Set up event listeners
        function setupEventListeners() {
            monthSelect.addEventListener('change', function() {
                currentMonth = this.value;
                currentWeekIndex = 0;
                updateWeekSelect();
                renderSchedule();
            });
            
            weekSelect.addEventListener('change', function() {
                currentWeekIndex = parseInt(this.value);
                updateWeekSelect();
                renderSchedule();
            });
            
            prevWeekBtn.addEventListener('click', function() {
                if (currentWeekIndex > 0) {
                    currentWeekIndex--;
                    updateWeekSelect();
                    renderSchedule();
                }
            });
            
            nextWeekBtn.addEventListener('click', function() {
                const month = NoticeData[currentMonth];
                if (currentWeekIndex < month.weeks.length - 1) {
                    currentWeekIndex++;
                    updateWeekSelect();
                    renderSchedule();
                }
            });
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>